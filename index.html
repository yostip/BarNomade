<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Bar Nomade">
  <meta name="theme-color" content="#39ff14">
  <meta name="description" content="Gestion des fûts pour les bars nomades du Hellfest 2026">
  <title>Gestion Fûts - Hellfest 2026</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  
  <!-- Preconnect pour accélérer les connexions CDN -->
  <link rel="preconnect" href="https://unpkg.com">
  <link rel="preconnect" href="https://cdn.tailwindcss.com">
  <link rel="preconnect" href="https://www.gstatic.com">
  
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { overscroll-behavior: none; background: #000; }
    @media (display-mode: standalone) {
      body { padding-top: env(safe-area-inset-top); }
    }
    /* Écran de chargement - simplifié */
    #loading-screen {
      position: fixed;
      inset: 0;
      background: #000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      color: #39ff14;
    }
    #loading-screen.hidden { display: none; }
    .loader-logo {
      width: 80px;
      height: 80px;
    }
  </style>
  
  <!-- Scripts critiques (chargement immédiat) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <!-- Babel supprimé - JS précompilé -->
  
  <!-- Firebase (critique) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  
  <!-- Scripts lourds chargés à la demande -->
  <script>
    window.loadJsPDF = () => !window.jspdf && new Promise(r => { const s = document.createElement('script'); s.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js'; s.onload = r; document.head.appendChild(s); });
    window.loadXLSX = () => !window.XLSX && new Promise(r => { const s = document.createElement('script'); s.src = 'https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js'; s.onload = r; document.head.appendChild(s); });
    window.loadChartJS = () => !window.Chart && new Promise(r => { const s = document.createElement('script'); s.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js'; s.onload = r; document.head.appendChild(s); });
  </script>
</head>
<body class="bg-black">
  <!-- Écran de chargement affiché immédiatement -->
  <div id="loading-screen">
    <img src="logo-hellfest.png" alt="Hellfest" class="loader-logo">
    <p style="margin-top: 20px; font-size: 18px;">Chargement...</p>
    <p style="margin-top: 8px; font-size: 12px; color: #39ff14; font-weight: bold;">HELLFEST 2026</p>
  </div>
  
  <div id="root"></div>
  
  <script>
(()=>{const{useState:m,useEffect:te,useCallback:cn,useRef:is}=React,Ya=()=>{const p=document.getElementById("loading-screen");p&&p.classList.add("hidden")},Za={apiKey:"AIzaSyCgl30syyCEJif9q96E2jzv-aTXxXgvgv0",authDomain:"gestion-futs-hellfest.firebaseapp.com",databaseURL:"https://gestion-futs-hellfest-default-rtdb.europe-west1.firebasedatabase.app",projectId:"gestion-futs-hellfest",storageBucket:"gestion-futs-hellfest.firebasestorage.app",messagingSenderId:"107509834680",appId:"1:107509834680:web:3a58295d3268b5d19f654d"},mn=firebase.initializeApp(Za),v=firebase.database(),Ve=(p,J)=>J==="super_admin"?p==="HF2026Admin":p==="Hellfest26",en=({onJoinSession:p})=>{const[J,A]=m("choice"),[Ne,re]=m(""),[X,Ke]=m(""),[Be,se]=m(""),[me,he]=m(!1),[u,Qe]=m(null),[w,Le]=m(!0),[ye,Oe]=m(!1),[$,_e]=m(""),[S,qe]=m(!1),[$e,Se]=m([]),[c,We]=m(!1),[O,Ye]=m(""),[K,Ze]=m("");React.useEffect(()=>{const R=new URLSearchParams(window.location.search).get("session");R&&(re(R.toUpperCase()),A("join"),window.history.replaceState({},document.title,window.location.pathname))},[]),React.useEffect(()=>{const F=localStorage.getItem("gestionFuts_session"),R=localStorage.getItem("gestionFuts_userName"),V=localStorage.getItem("gestionFuts_isAdmin"),q=localStorage.getItem("gestionFuts_isCreator");F&&R?v.ref(`sessions/${F}`).once("value",I=>{I.exists()?Qe({code:F,userName:R,isAdmin:V==="true",isCreator:q==="true"}):(localStorage.removeItem("gestionFuts_session"),localStorage.removeItem("gestionFuts_userName"),localStorage.removeItem("gestionFuts_isAdmin"),localStorage.removeItem("gestionFuts_isCreator")),Le(!1)}):Le(!1)},[]);const D=async()=>{u&&(he(!0),await v.ref(`sessions/${u.code}/users/${u.userName}`).update({lastActive:Date.now()}),p(u.code,u.userName,u.isCreator))},pe=()=>{localStorage.removeItem("gestionFuts_session"),localStorage.removeItem("gestionFuts_userName"),localStorage.removeItem("gestionFuts_isAdmin"),localStorage.removeItem("gestionFuts_isCreator"),Qe(null)},T=async()=>{We(!0);const R=(await v.ref("sessions").once("value")).val()||{},V=Object.entries(R).map(([q,I])=>{var M;return{code:q,createdAt:((M=I.config)==null?void 0:M.createdAt)||0,nombreBars:I.bars?Object.keys(I.bars).length:0,nombreUsers:I.users?Object.keys(I.users).length:0,historiqueCount:I.historique?Object.keys(I.historique).length:0,ventesCount:I.historiqueVentes?Object.keys(I.historiqueVentes).length:0}});V.sort((q,I)=>I.createdAt-q.createdAt),Se(V),We(!1)},we=()=>{localStorage.removeItem("gestionFuts_session"),localStorage.removeItem("gestionFuts_userName"),localStorage.removeItem("gestionFuts_isAdmin"),localStorage.removeItem("gestionFuts_isCreator"),localStorage.removeItem("gestionFuts_backups"),localStorage.removeItem("gestionFuts_tutorielVu")},Ft=async F=>{confirm(`Supprimer d\xE9finitivement la session ${F} ?

Toutes les donn\xE9es seront perdues (RGPD).`)&&(await v.ref(`sessions/${F}`).remove(),Se(V=>V.filter(q=>q.code!==F)),localStorage.getItem("gestionFuts_session")===F&&we())},Pe=async()=>{confirm(`\u26A0\uFE0F ATTENTION \u26A0\uFE0F

Supprimer TOUTES les ${$e.length} sessions ?

Cette action est IRR\xC9VERSIBLE !`)&&confirm(`Derni\xE8re confirmation :
Voulez-vous vraiment supprimer toutes les donn\xE9es ?`)&&(await v.ref("sessions").remove(),Se([]),we())},Ae=()=>{Ve($,"super_admin")?(qe(!0),T()):alert("Mot de passe incorrect")},et=()=>{const F="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let R="HF26-";for(let V=0;V<4;V++)R+=F.charAt(Math.floor(Math.random()*F.length));return R},ke=async()=>{if(!X.trim()){se("Entre ton pr\xE9nom");return}if(!Ve(O,"super_admin")){se("Mot de passe incorrect. Seul un administrateur peut cr\xE9er une session.");return}he(!0),se("");const R=et(),V=v.ref(`sessions/${R}`),q={config:{stockInitialBiere:50,stockInitialCidre:20,maxFutsParBar:3,nombreJours:4,createdAt:Date.now(),createdBy:X.trim()},creneaux:[{id:"c1",label:"11h30-13h"},{id:"c2",label:"13h-15h"},{id:"c3",label:"15h-18h"},{id:"c4",label:"18h-22h30"},{id:"c5",label:"22h30-00h30"}],jourActuel:1,users:{[X.trim()]:{joinedAt:Date.now(),lastActive:Date.now(),isSuperAdmin:!0}}};await V.set(q),p(R,X.trim(),!0)},Je=async()=>{if(!X.trim()){se("Entre ton pr\xE9nom");return}if(!Ne.trim()){se("Entre le code de session");return}he(!0),se("");const F=Ne.trim().toUpperCase(),R=v.ref(`sessions/${F}`);if(!(await R.once("value")).exists()){se("Session introuvable"),he(!1);return}const I=(await R.child("users").once("value")).val()||{};let M=X.trim();if(I[M]){const z=I[M];if(!(Date.now()-(z.lastActive||0)>12e4)){let be=2;for(;I[`${X.trim()} ${be}`];)be++;const at=`${X.trim()} ${be}`;if(!confirm(`Le nom "${M}" est d\xE9j\xE0 utilis\xE9 dans cette session.

Voulez-vous vous connecter sous "${at}" ?`)){he(!1);return}M=at}}const tt=K&&Ve(K,"super_admin"),xe={joinedAt:Date.now(),lastActive:Date.now()};tt&&(xe.isSuperAdmin=!0),await R.child(`users/${M}`).set(xe),p(F,M,tt)};return J==="choice"?React.createElement("div",{className:"min-h-screen bg-black flex items-center justify-center p-4"},React.createElement("div",{className:"w-full max-w-sm"},React.createElement("div",{className:"text-center mb-8"},React.createElement("img",{src:"logo-hellfest.png",alt:"Hellfest",className:"w-24 h-24 mx-auto mb-4"}),React.createElement("h1",{className:"text-2xl font-bold text-white mb-2"},"Gestion F\xFBts"),React.createElement("p",{className:"text-green-400 font-bold"},"HELLFEST 2026")),w?React.createElement("div",{className:"mb-6 p-4 bg-neutral-800 rounded-xl text-center"},React.createElement("p",{className:"text-neutral-400"},"Chargement...")):u&&React.createElement("div",{className:"mb-6 p-4 bg-green-900/30 border border-green-700 rounded-xl"},React.createElement("div",{className:"flex items-center justify-between mb-3"},React.createElement("span",{className:"text-green-400 font-bold"},"\u{1F4C2} Session r\xE9cente"),React.createElement("button",{onClick:pe,className:"text-xs text-neutral-500 hover:text-red-400",title:"Oublier cette session"},"\u2715")),React.createElement("div",{className:"mb-3"},React.createElement("p",{className:"text-white font-mono text-lg"},u.code),React.createElement("p",{className:"text-sm text-neutral-400"},"Connect\xE9 en tant que ",React.createElement("span",{className:"text-green-300"},u.userName),u.isCreator&&React.createElement("span",{className:"ml-2 text-xs bg-red-800 px-2 py-0.5 rounded"},"Cr\xE9ateur"),u.isAdmin&&!u.isCreator&&React.createElement("span",{className:"ml-2 text-xs bg-green-800 px-2 py-0.5 rounded"},"Admin"))),React.createElement("button",{onClick:D,disabled:me,className:"w-full py-3 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold transition-colors disabled:opacity-50"},me?"\u23F3 Connexion...":"\u{1F504} Reprendre cette session")),React.createElement("div",{className:"space-y-4"},React.createElement("button",{onClick:()=>A("create"),className:"w-full py-4 bg-red-600 text-white rounded-xl font-bold text-lg hover:bg-red-700 transition-colors"},"\u{1F195} Cr\xE9er une session"),React.createElement("button",{onClick:()=>A("join"),className:"w-full py-4 bg-neutral-800 text-white rounded-xl font-bold text-lg hover:bg-neutral-700 transition-colors border border-neutral-700"},"\u{1F517} Rejoindre une session")),React.createElement("button",{onClick:()=>Oe(!0),className:"mt-8 text-neutral-600 text-xs hover:text-neutral-400 transition-colors"},"\u{1F510} Administration")),ye&&React.createElement("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto border border-neutral-700"},React.createElement("div",{className:"flex items-center justify-between mb-4"},React.createElement("h3",{className:"text-xl font-bold text-red-400"},"\u{1F510} Super Admin"),React.createElement("button",{onClick:()=>{Oe(!1),qe(!1),_e("")},className:"text-neutral-400 hover:text-white"},"\u2715")),S?React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("p",{className:"text-green-400 text-sm"},"\u2713 Authentifi\xE9"),React.createElement("button",{onClick:T,className:"text-xs text-neutral-400 hover:text-white"},"\u{1F504} Actualiser")),React.createElement("div",{className:"bg-yellow-900/30 border border-yellow-700 rounded-lg p-3"},React.createElement("p",{className:"text-yellow-400 text-sm"},"\u26A0\uFE0F RGPD : La suppression est d\xE9finitive et irr\xE9versible.")),c?React.createElement("p",{className:"text-center text-neutral-400 py-4"},"Chargement..."):$e.length===0?React.createElement("p",{className:"text-center text-neutral-500 py-4"},"Aucune session trouv\xE9e"):React.createElement("div",{className:"space-y-2 max-h-64 overflow-y-auto"},$e.map(F=>React.createElement("div",{key:F.code,className:"bg-neutral-800 rounded-lg p-3 flex items-center justify-between"},React.createElement("div",null,React.createElement("p",{className:"font-mono font-bold text-white"},F.code),React.createElement("p",{className:"text-xs text-neutral-400"},F.createdAt?new Date(F.createdAt).toLocaleDateString("fr-FR"):"Date inconnue"," \u2022 ",F.nombreUsers," user(s) \u2022 ",F.historiqueCount+F.ventesCount," enregistrements")),React.createElement("button",{onClick:()=>Ft(F.code),className:"px-3 py-1 bg-red-600 hover:bg-red-500 rounded text-sm"},"\u{1F5D1}\uFE0F")))),$e.length>0&&React.createElement("button",{onClick:Pe,className:"w-full py-3 bg-red-900 hover:bg-red-800 rounded-lg font-medium border border-red-600 mt-4"},"\u{1F5D1}\uFE0F Supprimer TOUTES les sessions (",$e.length,")"),React.createElement("button",{onClick:()=>{confirm(`Purger toutes les donn\xE9es locales de cet appareil ?

(Backups, session m\xE9moris\xE9e, pr\xE9f\xE9rences)
Les donn\xE9es sur Firebase ne sont pas affect\xE9es.`)&&(we(),alert("\u2705 Donn\xE9es locales purg\xE9es."))},className:"w-full py-3 bg-neutral-800 hover:bg-neutral-700 rounded-lg font-medium border border-neutral-600 mt-2 text-neutral-300"},"\u{1F9F9} Purger les donn\xE9es locales de cet appareil")):React.createElement("div",{className:"space-y-4"},React.createElement("p",{className:"text-neutral-400 text-sm"},"Acc\xE8s r\xE9serv\xE9 \xE0 l'administrateur principal."),React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"Mot de passe Super Admin"),React.createElement("input",{type:"password",value:$,onChange:F=>_e(F.target.value),className:"w-full px-4 py-3 bg-neutral-800 rounded-lg",placeholder:"Mot de passe...",onKeyPress:F=>F.key==="Enter"&&Ae()})),React.createElement("button",{onClick:Ae,className:"w-full py-3 bg-red-600 rounded-lg font-medium"},"Acc\xE9der"))))):React.createElement("div",{className:"min-h-screen bg-black flex items-center justify-center p-4"},React.createElement("div",{className:"w-full max-w-sm"},React.createElement("button",{onClick:()=>{A("choice"),se(""),Ye("")},className:"text-neutral-400 mb-6 flex items-center gap-2"},"\u2190 Retour"),React.createElement("h2",{className:"text-xl font-bold text-white mb-6"},J==="create"?"\u{1F195} Nouvelle session":"\u{1F517} Rejoindre"),React.createElement("div",{className:"space-y-4"},React.createElement("div",null,React.createElement("label",{className:"block text-neutral-400 text-sm mb-2"},"Ton pr\xE9nom"),React.createElement("input",{type:"text",value:X,onChange:F=>Ke(F.target.value),className:"w-full px-4 py-3 bg-neutral-900 border border-neutral-700 rounded-xl text-white text-lg",placeholder:"Ex: Kevin"})),J==="create"&&React.createElement("div",null,React.createElement("label",{className:"block text-neutral-400 text-sm mb-2"},"\u{1F510} Mot de passe administrateur"),React.createElement("input",{type:"password",value:O,onChange:F=>Ye(F.target.value),className:"w-full px-4 py-3 bg-neutral-900 border border-neutral-700 rounded-xl text-white text-lg",placeholder:"Mot de passe..."}),React.createElement("p",{className:"text-neutral-500 text-xs mt-1"},"Requis pour cr\xE9er une nouvelle session")),J==="join"&&React.createElement("div",null,React.createElement("label",{className:"block text-neutral-400 text-sm mb-2"},"Code de session"),React.createElement("input",{type:"text",value:Ne,onChange:F=>re(F.target.value.toUpperCase()),className:"w-full px-4 py-3 bg-neutral-900 border border-neutral-700 rounded-xl text-white text-lg text-center tracking-widest",placeholder:"HF26-XXXX",maxLength:9})),J==="join"&&React.createElement("div",null,React.createElement("label",{className:"block text-neutral-400 text-sm mb-2"},"\u{1F511} Mot de passe Super Admin ",React.createElement("span",{className:"text-neutral-600"},"(optionnel)")),React.createElement("input",{type:"password",value:K,onChange:F=>Ze(F.target.value),className:"w-full px-4 py-3 bg-neutral-900 border border-neutral-700 rounded-xl text-white text-lg",placeholder:"Laisser vide si b\xE9n\xE9vole"}),React.createElement("p",{className:"text-neutral-600 text-xs mt-1"},"Remplir uniquement pour se connecter en Super Admin")),Be&&React.createElement("div",{className:"p-3 bg-red-900/50 border border-red-700 rounded-xl text-red-300 text-sm"},Be),React.createElement("button",{onClick:J==="create"?ke:Je,disabled:me,className:"w-full py-4 bg-red-600 text-white rounded-xl font-bold text-lg hover:bg-red-700 transition-colors disabled:opacity-50"},me?"\u23F3 Connexion...":J==="create"?"\u2728 Cr\xE9er":"\u{1F680} Rejoindre"))))},tn=()=>{var Us,zs,Hs,Gs,Xs;const[p,J]=m(null),[A,Ne]=m(""),[re,X]=m(!0),Ke=is(!1),[Be,se]=m([]),[me,he]=m({});te(()=>{Ya()},[]);const[u,Qe]=m({stockInitialBiere:50,stockInitialCidre:20,maxFutsParBar:3,nombreJours:4,prixPinte:6,prixPichet:15,prixGobelet:2,volumePinte:.5,volumePichet:1.5,volumeFutBiere:30,volumeFutCidre:20,seuilPerte:10}),[w,Le]=m([]),[ye,Oe]=m([]),[$,_e]=m([]),[S,qe]=m([]),[$e,Se]=m([]),[c,We]=m(1),[O,Ye]=m([{id:"c1",label:"11h30-13h"},{id:"c2",label:"13h-15h"},{id:"c3",label:"15h-18h"},{id:"c4",label:"18h-22h30"},{id:"c5",label:"22h30-00h30"}]),[K,Ze]=m({}),[D,pe]=m(!1),[T,we]=m(!1),[Ft,Pe]=m(!1),[Ae,et]=m(""),[ke,Je]=m(null),[F,R]=m(!1),[V,q]=m(!1),[I,M]=m(!1),[tt,xe]=m(!1),[z,st]=m(null),[$t,be]=m("choix"),[at,St]=m(""),[Pt,nt]=m(""),[Ws,rt]=m(!1),[Ys,ds]=m(!1),[Zs,At]=m(!1),[ea,lt]=m(!1),[Ee,Re]=m("planning"),[U,Me]=m(null),[Q,le]=m(null),[fe,ot]=m([]),[it,kt]=m(""),[W,Ue]=m(""),[oe,ze]=m(""),[us,Et]=m(""),[Rt,It]=m(""),[Tt,jt]=m(""),[Dt,Vt]=m(""),[cs,Bt]=m(""),[Ie,Lt]=m(!1),[ms,Ot]=m(""),[ps,_t]=m(!1),[xs,bs]=m({}),[ta,qt]=m(!1),[fs,Jt]=m(""),[sa,He]=m(null),[Mt,gs]=m(""),[Ut,vs]=m(null),k=(e,t="success")=>{vs({message:e,type:t}),setTimeout(()=>vs(null),3e3)},[Y,ge]=m(!1),[zt,aa]=m("tous"),[Ht,na]=m("tous"),[Gt,ra]=m(""),[Xt,la]=m(""),[oa,Ns]=m(!1),[ve,dt]=m("synthese"),[ia,hs]=m(!1),[sn,ys]=m([]),[Ce,ws]=m([]),[da,Cs]=m(!1),[Fs,$s]=m([]),[Kt,Ss]=m(!1),[ut,Ps]=m(""),[ua,Qt]=m(!1),[_,ct]=m(null),[ca,mt]=m(!1),[ae,pt]=m(0),[Ge,As]=m(""),[an,nn]=m(!1),[ma,ks]=m(!1),[H,Wt]=m(!1),[xt,Es]=m({}),[Te,bt]=m(null),[pa,ft]=m(null),[,xa]=m(0),ba=e=>{const s=Date.now()-e,n=Math.floor(s/(1e3*60*60)),r=Math.floor(s%(1e3*60*60)/(1e3*60));return n>0?`${n}h${r.toString().padStart(2,"0")}`:`${r}min`},Rs=e=>{const t=(Date.now()-e)/36e5;return t>=4?"bg-red-600 text-white":t>=3?"bg-orange-500 text-white":t>=1.5?"bg-yellow-500 text-black":"bg-neutral-700"},Is=["bg-red-600","bg-blue-600","bg-green-600","bg-yellow-600","bg-purple-600","bg-pink-600","bg-indigo-600","bg-teal-600","bg-orange-600","bg-cyan-600"],Ts=e=>{const t=w.findIndex(s=>s.id===e);return Is[t%Is.length]};te(()=>{if(!p)return;const e=v.ref(`sessions/${p}`);e.child("config").on("value",a=>{a.val()&&Qe(a.val())}),e.child("config/adminEmail").on("value",a=>{a.val()&&As(a.val())}),e.child("barsNomades").on("value",a=>{if(a.val()){const o=Object.entries(a.val()).map(([d,b])=>({id:d,...b}));Le(o),o.length>0&&!U&&Me(o[0].id)}else Le([])}),e.child("barPositions").on("value",a=>{a.val()?Es(a.val()):Es({})}),e.child("historique").on("value",a=>{if(a.val()){const o=Object.entries(a.val()).map(([d,b])=>({id:d,...b}));o.sort((d,b)=>b.timestamp-d.timestamp),_e(o)}else _e([])}),e.child("historiqueVentes").on("value",a=>{if(a.val()){const o=Object.entries(a.val()).map(([d,b])=>({id:d,...b}));o.sort((d,b)=>b.timestamp-d.timestamp),qe(o)}else qe([])}),e.child("creneauxUtilises").on("value",a=>{a.val()?bs(a.val()):bs({})}),e.child("benevoles").on("value",a=>{if(a.val()){const o=Object.entries(a.val()).map(([d,b])=>({id:d,...b}));Se(o)}else Se([])}),e.child("users").on("value",a=>{if(a.val()){const o=Object.keys(a.val());se(o),he(a.val())}}),e.child("jourActuel").on("value",a=>{a.val()&&We(a.val())}),e.child("creneaux").on("value",a=>{if(a.val()){const o=Array.isArray(a.val())?a.val():Object.values(a.val());Ye(o)}}),e.child("futsEnAttente").on("value",a=>{if(a.val()){const o=Object.entries(a.val()).map(([d,b])=>({id:d,...b}));Oe(o)}else Oe([])});const t=v.ref(".info/connected");t.on("value",a=>{X(a.val()===!0)});const s=setInterval(()=>{e.child(`users/${A}/lastActive`).set(Date.now())},3e4),n=e.child(`users/${A}`);n.on("value",a=>{!a.exists()&&p&&!Ke.current&&(alert("Vous avez \xE9t\xE9 d\xE9connect\xE9 par un administrateur."),J(null),Ne(""),pe(!1))});const r=[e.child("config"),e.child("config/adminEmail"),e.child("barsNomades"),e.child("barPositions"),e.child("historique"),e.child("historiqueVentes"),e.child("creneauxUtilises"),e.child("benevoles"),e.child("users"),e.child("jourActuel"),e.child("creneaux"),e.child("futsEnAttente")];return()=>{r.forEach(a=>a.off()),n.off(),t.off(),clearInterval(s)}},[p,A]),te(()=>{const e=setInterval(()=>{xa(t=>t+1)},6e4);return()=>clearInterval(e)},[]),te(()=>{if(!p||!T||!Ge)return;let e=!1;const t=setInterval(()=>{const s=new Date,n=s.getHours(),r=s.getMinutes();n===0&&r===30&&!e&&(e=!0,fa(),setTimeout(()=>{e=!1},12e4))},3e4);return()=>clearInterval(t)},[p,T,Ge,c]);const fa=()=>{Ms().save(`Bilan_J${c}_${new Date().toISOString().split("T")[0]}.pdf`);const t=ns(),s=yt();let n=`[Hellfest 2026] Bilan J${c} - ${t.totalVentesJour.toFixed(2)}\u20AC`,r=`Bilan automatique J${c} - ${new Date().toLocaleDateString("fr-FR")}%0D%0A%0D%0A`;r+="R\xC9SUM\xC9:%0D%0A",r+=`- Ventes du jour: ${t.totalVentesJour.toFixed(2)}\u20AC%0D%0A`,r+=`- F\xFBts en circulation: ${t.futsEnCirculation}%0D%0A`,s&&(r+=`%0D%0ACOMPARAISON J${s.jour} vs J${s.jourMoins1}:%0D%0A`,r+=`- \xC9cart ventes: ${s.ecartVentes>=0?"+":""}${s.ecartVentes.toFixed(2)}\u20AC (${s.ecartPourcent}%)%0D%0A`),r+="%0D%0ALe PDF d\xE9taill\xE9 a \xE9t\xE9 t\xE9l\xE9charg\xE9 automatiquement.%0D%0A",r+=`Session: ${p}`,window.open(`mailto:${Ge}?subject=${encodeURIComponent(n)}&body=${r}`,"_blank"),k("\u{1F4E7} Bilan g\xE9n\xE9r\xE9 - V\xE9rifiez votre client mail")};te(()=>{if(!p)return;const e=v.ref(`sessions/${p}/annonces`);return e.orderByChild("timestamp").limitToLast(5).on("value",t=>{if(t.val()){const s=Object.entries(t.val()).map(([n,r])=>({id:n,...r}));s.sort((n,r)=>r.timestamp-n.timestamp),$s(s)}else $s([])}),()=>e.off()},[p]),te(()=>{re&&Ce.length>0&&!da&&ga()},[re,Ce]);const ga=async()=>{if(Ce.length!==0){Cs(!0);for(const e of Ce)try{e.type==="SORTIE"?(await v.ref(`sessions/${p}/barsNomades/${e.barId}/futs`).set(e.futs),await v.ref(`sessions/${p}/historique`).push(e.historique)):e.type==="VENTE"&&await v.ref(`sessions/${p}/historiqueVentes`).push(e.data)}catch(t){console.error("Erreur sync:",t)}ws([]),Cs(!1),k(`\u2705 ${Ce.length} action(s) synchronis\xE9e(s)`)}},rn=e=>{ws(t=>[...t,e]),k("\u23F3 Action en attente (hors-ligne)","warning")};te(()=>{if(!p)return;const e=setInterval(()=>{const t={session:p,timestamp:Date.now(),config:u,barsNomades:w,historique:$,historiqueVentes:S,affectations:K,jourActuel:c},s=JSON.parse(localStorage.getItem("gestionFuts_backups")||"[]");s.unshift(t);const n=s.slice(0,8);localStorage.setItem("gestionFuts_backups",JSON.stringify(n)),console.log("Backup automatique effectu\xE9:",new Date().toLocaleString())},36e5);return setTimeout(()=>{const t={session:p,timestamp:Date.now(),config:u,barsNomades:w,historique:$,historiqueVentes:S,affectations:K,jourActuel:c},s=JSON.parse(localStorage.getItem("gestionFuts_backups")||"[]");s.unshift(t),localStorage.setItem("gestionFuts_backups",JSON.stringify(s.slice(0,8)))},5e3),()=>clearInterval(e)},[p,u,w,$,S,K,c]),te(()=>{if(!p||!c)return;const e=v.ref(`sessions/${p}/affectations/jour${c}`);return e.on("value",t=>{t.val()?Ze(t.val()):Ze({})}),()=>{e.off()}},[p,c]),te(()=>{if(!p)return;const e=v.ref(`sessions/${p}/auditLogs`);return e.orderByChild("timestamp").limitToLast(100).on("value",t=>{if(t.val()){const s=Object.entries(t.val()).map(([n,r])=>({id:n,...r}));s.sort((n,r)=>r.timestamp-n.timestamp),ys(s)}else ys([])}),()=>{e.off()}},[p]);const va=async e=>{var t;if(!(!T||e===A)){if(e===u.createdBy){alert("Impossible d'\xE9jecter le cr\xE9ateur de la session.");return}if((t=me[e])!=null&&t.isSuperAdmin){alert("Impossible d'\xE9jecter un Super Admin.");return}confirm(`\xCAtes-vous s\xFBr de vouloir \xE9jecter ${e} ?`)&&await v.ref(`sessions/${p}/users/${e}`).remove()}},ie=u.stockInitialBiere-$.filter(e=>!e.annule&&e.type==="SORTIE"&&e.typeFut==="biere").length+$.filter(e=>!e.annule&&e.type==="RETOUR_PLEIN"&&e.typeFut==="biere").length,de=u.stockInitialCidre-$.filter(e=>!e.annule&&e.type==="SORTIE"&&e.typeFut==="cidre").length+$.filter(e=>!e.annule&&e.type==="RETOUR_PLEIN"&&e.typeFut==="cidre").length,Na=$.filter(e=>!e.annule&&e.type==="RETOUR_VIDE").length,ha=$.filter(e=>!e.annule&&e.type==="RETOUR_CASSE").length,ya=$.filter(e=>!e.annule&&e.type==="RETOUR_REUTILISABLE").length,ln=$.filter(e=>!e.annule&&e.type==="RETOUR_PLEIN").length,js=S.filter(e=>!e.annule).reduce((e,t)=>e+(t.montant||0),0),ue=(()=>{let e=0;return Object.values(K).forEach(t=>{Object.values(t||{}).forEach(s=>{var n,r,a;s&&((n=s.vendeur)!=null&&n.nom||(r=s.serveur)!=null&&r.nom||(a=s.runner)!=null&&a.nom)&&e++})}),e})(),wa=(e,t,s=!1)=>{J(e),Ne(t),s&&(pe(!0),we(!0)),localStorage.setItem("gestionFuts_session",e),localStorage.setItem("gestionFuts_userName",t),s&&(localStorage.setItem("gestionFuts_isAdmin","true"),localStorage.setItem("gestionFuts_isCreator","true")),localStorage.getItem("gestionFuts_tutorielVu")||setTimeout(()=>{mt(!0),pt(0)},500)},Ca=()=>{confirm("Voulez-vous vous d\xE9connecter de cette session ?")&&(Ke.current=!0,p&&A&&v.ref(`sessions/${p}/users/${A}`).remove(),localStorage.removeItem("gestionFuts_session"),localStorage.removeItem("gestionFuts_userName"),localStorage.removeItem("gestionFuts_isAdmin"),localStorage.removeItem("gestionFuts_isCreator"),J(null),Ne(""),pe(!1),we(!1))},dn=()=>{localStorage.removeItem("gestionFuts_session"),localStorage.removeItem("gestionFuts_userName"),localStorage.removeItem("gestionFuts_isAdmin"),localStorage.removeItem("gestionFuts_isCreator")},Xe=e=>{D?Yt(e):(Je(e),et(""),Pe(!0))},Ds=()=>{if(Ve(Ae,"super_admin")){pe(!0),we(!0),v.ref(`sessions/${p}/users/${A}`).update({isSuperAdmin:!0}),localStorage.setItem("gestionFuts_isAdmin","true"),localStorage.setItem("gestionFuts_isCreator","true"),Pe(!1),ke&&(Yt(ke),Je(null));return}Ve(Ae,"admin")?(pe(!0),Pe(!1),ke&&(Yt(ke),Je(null))):alert("Mot de passe incorrect")},Yt=e=>{switch(e){case"parametres":R(!0);break;case"export":xe(!0);break;case"historique":q(!V);break;case"ventes":M(!I);break;case"jour_prev":c>1&&v.ref(`sessions/${p}/jourActuel`).set(c-1);break;case"jour_next":c<u.nombreJours&&v.ref(`sessions/${p}/jourActuel`).set(c+1);break}},Fa=async(e,t)=>{await v.ref(`sessions/${p}/barsNomades`).push().set({nom:e,type:t,futs:[]})},$a=async e=>{var s;const t=w.find(n=>n.id===e);if(((s=t==null?void 0:t.futs)==null?void 0:s.length)>0){alert("Impossible de supprimer un bar avec des f\xFBts en cours");return}await v.ref(`sessions/${p}/barsNomades/${e}`).remove();for(let n=1;n<=u.nombreJours;n++)await v.ref(`sessions/${p}/affectations/jour${n}/${e}`).remove()},Vs=async(e,t)=>{t.trim()&&(await v.ref(`sessions/${p}/barsNomades/${e}/nom`).set(t.trim()),k(`\u2705 Bar renomm\xE9 en "${t.trim()}"`))},gt=async(e,t)=>{const s={action:e,details:t,user:A,timestamp:Date.now(),jour:c};await v.ref(`sessions/${p}/auditLogs`).push(s)},Sa=async e=>{if(Y)return;const t=w.find(r=>r.id===e);if(!t)return;const s=t.futs||[];if(s.length>=u.maxFutsParBar)return;const n=t.type;if(!(n==="biere"&&ie<=0)&&!(n==="cidre"&&de<=0)){ge(!0);try{const r={id:Date.now().toString(),type:n,dateAttribution:Date.now()},a=[...s,r];await v.ref(`sessions/${p}/barsNomades/${e}/futs`).set(a),await v.ref(`sessions/${p}/historique`).push({type:"SORTIE",typeFut:n,barId:e,barNom:t.nom,jour:c,timestamp:Date.now(),user:A}),await gt("SORTIE_FUT",`${n==="biere"?"\u{1F37A} Bi\xE8re":"\u{1F34E} Cidre"} \u2192 ${t.nom}`),k(`\u2705 F\xFBt ${n==="biere"?"\u{1F37A}":"\u{1F34E}"} attribu\xE9 \xE0 ${t.nom}`)}catch(r){k("\u274C Erreur lors de l'attribution","error")}finally{setTimeout(()=>ge(!1),1e3)}}},vt=async(e,t,s,n="")=>{if(Y)return;const r=w.find(d=>d.id===e);if(!r)return;const a=r.futs||[],o=a[t];if(o){ge(!0);try{const d=a.filter((g,i)=>i!==t);await v.ref(`sessions/${p}/barsNomades/${e}/futs`).set(d.length>0?d:null);const b={type:s,typeFut:o.type,barId:e,barNom:r.nom,jour:c,timestamp:Date.now(),user:A};n.trim()&&(b.commentaire=n.trim()),await v.ref(`sessions/${p}/historique`).push(b),s==="RETOUR_REUTILISABLE"&&await v.ref(`sessions/${p}/futsEnAttente`).push({typeFut:o.type,barId:e,barNom:r.nom,jourOrigine:c,timestamp:Date.now(),user:A});const l={RETOUR_VIDE:"\u{1F4E6} Vide",RETOUR_CASSE:"\u{1F4A5} Cass\xE9",RETOUR_REUTILISABLE:"\u267B\uFE0F Non termin\xE9",RETOUR_PLEIN:"\u{1F504} Plein (r\xE9int\xE9gr\xE9 au stock)"};await gt("RETOUR_FUT",`${l[s]} de ${r.nom}`),k(`\u2705 F\xFBt retourn\xE9 (${l[s]})`)}catch(d){k("\u274C Erreur lors du retour","error")}finally{setTimeout(()=>ge(!1),1e3)}st(null),be("choix"),St(""),nt("")}},Pa=async(e,t)=>{const s=w.find(b=>b.id===t);if(!s)return;const r=(await v.ref(`sessions/${p}/futsEnAttente/${e}`).once("value")).val();if(!r)return;const a=s.futs||[],o={type:r.typeFut,addedAt:Date.now(),reprisDe:r.jourOrigine},d=[...a,o];await v.ref(`sessions/${p}/barsNomades/${t}/futs`).set(d),await v.ref(`sessions/${p}/historique`).push({type:"REPRISE",typeFut:r.typeFut,barId:t,barNom:s.nom,jour:c,timestamp:Date.now(),user:A,commentaire:`Reprise du J${r.jourOrigine}`}),await v.ref(`sessions/${p}/futsEnAttente/${e}`).remove()},Aa=async()=>{if(!W||Y)return;if(!oe){k("\u274C S\xE9lectionnez un cr\xE9neau horaire","error");return}if(Rt===""||Tt===""||Dt===""){k("\u274C Renseignez le nombre de pintes, pichets et gobelets","error");return}const e=parseFloat(us)||0;if(e<=0){k("\u274C Le montant doit \xEAtre sup\xE9rieur \xE0 0","error");return}const t=w.find(s=>s.id===W);ge(!0);try{if(await v.ref(`sessions/${p}/historiqueVentes`).push({barId:W,barNom:(t==null?void 0:t.nom)||"Bar inconnu",creneau:oe,montant:e,nbPintes:parseInt(Rt)||0,nbPichets:parseInt(Tt)||0,nbGobelets:parseInt(Dt)||0,equipementDefaillant:Ie,numEquipement:Ie?ms.trim():"",donneesPartielles:Ie?ps:!1,commentaire:cs,jour:c,timestamp:Date.now(),user:A}),!Ie){const s=`J${c}_${W}_${oe}`;await v.ref(`sessions/${p}/creneauxUtilises/${s}`).set({barId:W,creneau:oe,jour:c,timestamp:Date.now(),user:A}),await v.ref(`sessions/${p}/creneauxEnAttente/${s}`).remove()}await gt("VENTE",`${e.toFixed(2)}\u20AC - ${(t==null?void 0:t.nom)||"Bar inconnu"} (${oe})`),k(`\u2705 Vente enregistr\xE9e (${e.toFixed(2)}\u20AC)`),rt(!1),Ue(""),ze(""),Et(""),It(""),jt(""),Vt(""),Lt(!1),Ot(""),_t(!1),Bt("")}catch(s){k("\u274C Erreur lors de l'enregistrement","error")}finally{setTimeout(()=>ge(!1),1e3)}},ka=async e=>{await v.ref(`sessions/${p}/config`).update(e),R(!1)},Ea=async(e,t,s)=>{await v.ref(`sessions/${p}/barPositions/${e}`).set({x:t,y:s})},Ra=e=>{if(!H||!Te)return;const t=e.currentTarget.getBoundingClientRect(),s=(e.clientX-t.left)/t.width*100,n=(e.clientY-t.top)/t.height*100;Ea(Te,s,n);const r=w.filter(o=>!xt[o.id]),a=r.findIndex(o=>o.id===Te);a<r.length-1?bt(r[a+1].id):(bt(null),Wt(!1),k("\u2705 Tous les bars sont positionn\xE9s !"))},Ia=async e=>{await v.ref(`sessions/${p}/barPositions/${e}`).remove()},Ta=async()=>{confirm("R\xE9initialiser toutes les positions des bars sur le plan ?")&&(await v.ref(`sessions/${p}/barPositions`).remove(),k("Positions r\xE9initialis\xE9es"))},Bs=async e=>{if(!Ve(fs,"admin")){alert("Mot de passe incorrect");return}e&&(Os(),_s(),ts()),await v.ref(`sessions/${p}/historique`).remove(),await v.ref(`sessions/${p}/historiqueVentes`).remove(),await v.ref(`sessions/${p}/affectations`).remove(),await v.ref(`sessions/${p}/futsEnAttente`).remove(),await v.ref(`sessions/${p}/creneauxUtilises`).remove(),await v.ref(`sessions/${p}/creneauxEnAttente`).remove();for(const s of w)await v.ref(`sessions/${p}/barsNomades/${s.id}/futs`).set(null);qt(!1),Jt(""),alert("R\xE9initialisation effectu\xE9e !")},ja=async e=>{const t=S.find(n=>n.id===e);if(!t||!confirm(`Annuler cette vente ?

Le cr\xE9neau sera de nouveau disponible pour une nouvelle saisie.`))return;await v.ref(`sessions/${p}/historiqueVentes/${e}`).update({annule:!0,annulePar:A,annuleLe:Date.now()});const s=`J${t.jour}_${t.barId}_${t.creneau}`;await v.ref(`sessions/${p}/creneauxUtilises/${s}`).remove(),k("\u2705 Vente annul\xE9e, cr\xE9neau lib\xE9r\xE9")},Da=async e=>{const t=$.find(o=>o.id===e);if(!t)return;let s=`Annuler ce mouvement de f\xFBt ?

`;if(t.type==="SORTIE"||t.type==="REPRISE"?s+=`\u2192 Le f\xFBt ${t.typeFut==="biere"?"\u{1F37A} Bi\xE8re":"\u{1F34E} Cidre"} sera RETIR\xC9 du bar "${t.barNom}"`:s+=`\u2192 Le f\xFBt ${t.typeFut==="biere"?"\u{1F37A} Bi\xE8re":"\u{1F34E} Cidre"} sera REMIS dans le bar "${t.barNom}"`,!confirm(s))return;await v.ref(`sessions/${p}/historique/${e}`).update({annule:!0,annulePar:A,annuleLe:Date.now()});const n=v.ref(`sessions/${p}/barsNomades/${t.barId}/futs`);let a=(await n.once("value")).val()||[];if(Array.isArray(a)||(a=Object.values(a)),t.type==="SORTIE"||t.type==="REPRISE"){let o=-1;for(let d=a.length-1;d>=0;d--)if(a[d]&&a[d].type===t.typeFut){o=d;break}o!==-1&&(a.splice(o,1),await n.set(a.length>0?a:null)),t.type==="REPRISE"&&await v.ref(`sessions/${p}/futsEnAttente`).push({typeFut:t.typeFut,barId:t.barId,barNom:t.barNom,jourOrigine:c,timestamp:Date.now(),user:A})}else if((t.type==="RETOUR_VIDE"||t.type==="RETOUR_CASSE"||t.type==="RETOUR_REUTILISABLE"||t.type==="RETOUR_PLEIN")&&(a.push({type:t.typeFut,addedAt:Date.now()}),await n.set(a),t.type==="RETOUR_REUTILISABLE")){const d=(await v.ref(`sessions/${p}/futsEnAttente`).once("value")).val();if(d){for(const[b,l]of Object.entries(d))if(l.barId===t.barId&&l.typeFut===t.typeFut&&l.jourOrigine===t.jour){await v.ref(`sessions/${p}/futsEnAttente/${b}`).remove();break}}}},Va=()=>{Re("planning"),w.length>0&&!U&&Me(w[0].id),ds(!0)},Nt=(e,t)=>{var s;return((s=K[e])==null?void 0:s[t])||null},Ba=(e,t)=>{const s=Nt(e,t)||{vendeur:{nom:"",prenom:""},serveur:{nom:"",prenom:""},runner:{nom:"",prenom:""}};le({barId:e,creneauId:t,vendeur:{...s.vendeur},serveur:{...s.serveur},runner:{...s.runner}}),At(!0)},La=async()=>{if(!Q)return;const{barId:e,creneauId:t,vendeur:s,serveur:n,runner:r}=Q;await v.ref(`sessions/${p}/affectations/jour${c}/${e}/${t}`).set({vendeur:s,serveur:n,runner:r}),At(!1),le(null)},Oa=async(e,t)=>{await v.ref(`sessions/${p}/affectations/jour${c}/${e}/${t}`).remove()},_a=()=>{ot([...O]),kt(""),Re("parametres")},Ls=()=>{if(it.trim()&&fe.length<10){const e="c"+Date.now();ot([...fe,{id:e,label:it.trim()}]),kt("")}},qa=e=>{ot(fe.filter(t=>t.id!==e))},Ja=async()=>{await v.ref(`sessions/${p}/creneaux`).set(fe),Re("planning")},ce=e=>!e||!e.nom&&!e.prenom?"-":`${e.prenom||""} ${e.nom||""}`.trim(),ht=e=>new Date(e).toLocaleString("fr-FR"),Zt=()=>{const e=new Date;return`${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}_${String(e.getHours()).padStart(2,"0")}${String(e.getMinutes()).padStart(2,"0")}`},es=(e,t)=>{const n=new Blob(["\uFEFF"+t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)},Os=()=>{if($.length===0)return;const e=["Date/Heure","Type","F\xFBt","Bar","Jour","Utilisateur","Commentaire","Annul\xE9","Annul\xE9 par","Date annulation"],t=$.map(s=>[`"${ht(s.timestamp)}"`,`"${s.type}"`,`"${s.typeFut}"`,`"${s.barNom}"`,s.jour,`"${s.user}"`,`"${s.commentaire||""}"`,s.annule?"Oui":"Non",`"${s.annulePar||""}"`,s.annuleLe?`"${ht(s.annuleLe)}"`:'""'].join(";"));es(`Historique_Futs_${Zt()}.csv`,e.join(";")+`
`+t.join(`
`))},_s=()=>{if(S.length===0)return;const e=["Date/Heure","Bar","Montant","Pintes","Pichets","Gobelets","Jour","\xC9quip. d\xE9faillant","N\xB0 \xE9quipement","Donn\xE9es partielles","Commentaire","Annul\xE9","Annul\xE9 par","Date annulation"],t=S.map(n=>[`"${ht(n.timestamp)}"`,`"${n.barNom}"`,(n.montant||0).toFixed(2).replace(".",","),n.nbPintes||0,n.nbPichets||0,n.nbGobelets||0,n.jour,n.equipementDefaillant?"Oui":"Non",`"${n.numEquipement||""}"`,n.donneesPartielles?"Oui":"Non",`"${n.commentaire||""}"`,n.annule?"Oui":"Non",`"${n.annulePar||""}"`,n.annuleLe?`"${ht(n.annuleLe)}"`:'""'].join(";")),s=S.filter(n=>!n.annule).reduce((n,r)=>n+(r.montant||0),0);es(`Historique_Ventes_${Zt()}.csv`,e.join(";")+`
`+t.join(`
`)+`

TOTAL;`+s.toFixed(2).replace(".",",")+" \u20AC")},ts=()=>{if(ue===0)return;const e=["Jour","Bar Nomade","Cr\xE9neau","Vendeur","Serveur","Runner"],t=[];w.forEach(s=>{O.forEach(n=>{const r=Nt(s.id,n.id);t.push([`J${c}`,`"${s.nom}"`,`"${n.label}"`,`"${r?ce(r.vendeur):"-"}"`,`"${r?ce(r.serveur):"-"}"`,`"${r?ce(r.runner):"-"}"`].join(";"))})}),es(`Planning_Benevoles_J${c}_${Zt()}.csv`,e.join(";")+`
`+t.join(`
`)+`

Jour;J`+c+`
Total affectations;`+ue)},Ma=async()=>{if(c<=1)return;const e=c-1,s=(await v.ref(`sessions/${p}/affectations/jour${e}`).once("value")).val();if(!s){k(`\u274C Aucune affectation trouv\xE9e pour J${e}`,"error");return}if(confirm(`Copier les affectations de J${e} vers J${c} ?

Les affectations existantes seront \xE9cras\xE9es.`)){ge(!0);try{await v.ref(`sessions/${p}/affectations/jour${c}`).set(s),await gt("COPIE_AFFECTATIONS",`Copie de J${e} vers J${c}`),k(`\u2705 Affectations copi\xE9es depuis J${e}`)}catch(n){k("\u274C Erreur lors de la copie","error")}finally{setTimeout(()=>ge(!1),1e3)}}},ss=$.filter(e=>{var t,s,n,r;if(zt!=="tous"&&e.jour!==parseInt(zt))return!1;if(Gt.trim()){const a=Gt.toLowerCase();return((t=e.barNom)==null?void 0:t.toLowerCase().includes(a))||((s=e.user)==null?void 0:s.toLowerCase().includes(a))||((n=e.type)==null?void 0:n.toLowerCase().includes(a))||((r=e.commentaire)==null?void 0:r.toLowerCase().includes(a))}return!0}),as=S.filter(e=>{var t,s,n;if(Ht!=="tous"&&e.jour!==parseInt(Ht))return!1;if(Xt.trim()){const r=Xt.toLowerCase();return((t=e.barNom)==null?void 0:t.toLowerCase().includes(r))||((s=e.user)==null?void 0:s.toLowerCase().includes(r))||((n=e.commentaire)==null?void 0:n.toLowerCase().includes(r))}return!0}),ns=()=>{const e=$.filter(a=>!a.annule&&a.jour===c),t=e.filter(a=>a.type==="SORTIE").length-e.filter(a=>a.type.startsWith("RETOUR_")).length,s={};for(let a=1;a<=u.nombreJours;a++)s[a]=S.filter(o=>!o.annule&&o.jour===a).reduce((o,d)=>o+(d.montant||0),0);const n=w.filter(a=>!a.futs||a.futs.length===0),r=S.filter(a=>!a.annule&&a.equipementDefaillant&&a.jour===c);return{futsEnCirculation:t,ventesParJour:s,barsSansFut:n,equipementsDefaillants:r,totalVentesJour:s[c]||0}},yt=()=>{if(c<=1)return null;const e=new Date().getHours(),t=new Date().getMinutes(),s=S.filter(y=>!y.annule&&y.jour===c),n=s.reduce((y,h)=>y+(h.montant||0),0),r=s.length,a=S.filter(y=>{if(y.annule||y.jour!==c-1)return!1;const h=new Date(y.timestamp).getHours(),C=new Date(y.timestamp).getMinutes();return h<e||h===e&&C<=t}),o=a.reduce((y,h)=>y+(h.montant||0),0),d=a.length,b=S.filter(y=>!y.annule&&y.jour===c-1).reduce((y,h)=>y+(h.montant||0),0),l=$.filter(y=>!y.annule&&y.jour===c&&y.type==="SORTIE").length,g=$.filter(y=>{if(y.annule||y.jour!==c-1||y.type!=="SORTIE")return!1;const h=new Date(y.timestamp).getHours();return h<e||h===e}).length,i=n-o,x=o>0?(i/o*100).toFixed(1):0,N=l-g;return{jour:c,jourMoins1:c-1,heureComparaison:`${e}h${t.toString().padStart(2,"0")}`,ventesJour:n,ventesJMoins1:o,totalFinalJMoins1:b,ecartVentes:i,ecartPourcent:parseFloat(x),tendance:i>=0?"hausse":"baisse",nbTransactionsJour:r,nbTransactionsJMoins1:d,futsJour:l,futsJMoins1:g,ecartFuts:N}},je=(e=c)=>{const t=$.filter(P=>!P.annule&&P.jour===e&&P.type==="RETOUR_VIDE"&&P.typeFut==="biere").length,s=$.filter(P=>!P.annule&&P.jour===e&&P.type==="RETOUR_VIDE"&&P.typeFut==="cidre").length,n=t*u.volumeFutBiere,r=s*u.volumeFutCidre,a=S.filter(P=>!P.annule&&P.jour===e),o=a.filter(P=>{const E=w.find(os=>os.id===P.barId);return(E==null?void 0:E.type)==="biere"}),d=a.filter(P=>{const E=w.find(os=>os.id===P.barId);return(E==null?void 0:E.type)==="cidre"}),b=o.reduce((P,E)=>P+(E.nbPintes||0),0),l=o.reduce((P,E)=>P+(E.nbPichets||0),0),g=o.reduce((P,E)=>P+(E.nbGobelets||0),0),i=d.reduce((P,E)=>P+(E.nbPintes||0),0),x=d.reduce((P,E)=>P+(E.nbPichets||0),0),N=d.reduce((P,E)=>P+(E.nbGobelets||0),0),y=b*u.volumePinte+l*u.volumePichet,h=i*u.volumePinte+x*u.volumePichet,C=o.reduce((P,E)=>P+(E.montant||0),0),j=d.reduce((P,E)=>P+(E.montant||0),0),B=b*u.prixPinte+l*u.prixPichet+g*u.prixGobelet,Z=i*u.prixPinte+x*u.prixPichet+N*u.prixGobelet,ne=n-y,ee=r-h,f=n>0?ne/n*100:0,L=r>0?ee/r*100:0,G=n+r>0?(ne+ee)/(n+r)*100:0,Fe=C-B,Ct=j-Z,Qa=B>0?C/B*100:100,Wa=Z>0?j/Z*100:100,Ks=ne>0?ne/u.volumePinte*u.prixPinte:0,Qs=ee>0?ee/u.volumePinte*u.prixPinte:0,ls=P=>P<=u.seuilPerte?"ok":P<=u.seuilPerte*1.5?"attention":"alerte";return{biere:{futsVides:t,volumeSorti:n,pintes:b,pichets:l,gobelets:g,volumeVendu:y,ecartVolume:ne,tauxPerte:f,statutPerte:ls(f),caDeclare:C,caTheorique:B,ecartCa:Fe,coherenceCa:Qa,manqueAGagner:Ks},cidre:{futsVides:s,volumeSorti:r,pintes:i,pichets:x,gobelets:N,volumeVendu:h,ecartVolume:ee,tauxPerte:L,statutPerte:ls(L),caDeclare:j,caTheorique:Z,ecartCa:Ct,coherenceCa:Wa,manqueAGagner:Qs},total:{futsVides:t+s,volumeSorti:n+r,volumeVendu:y+h,ecartVolume:ne+ee,tauxPerte:G,statutPerte:ls(G),caDeclare:C+j,caTheorique:B+Z,ecartCa:Fe+Ct,manqueAGagner:Ks+Qs}}},De=(e=c)=>w.map(t=>{const n=t.type==="biere"?u.volumeFutBiere:u.volumeFutCidre,r=$.filter(C=>!C.annule&&C.jour===e&&C.type==="RETOUR_VIDE"&&C.barId===t.id).length,a=r*n,o=S.filter(C=>!C.annule&&C.jour===e&&C.barId===t.id),d=o.reduce((C,j)=>C+(j.nbPintes||0),0),b=o.reduce((C,j)=>C+(j.nbPichets||0),0),l=o.reduce((C,j)=>C+(j.nbGobelets||0),0),g=d*u.volumePinte+b*u.volumePichet,i=a-g,x=a>0?i/a*100:0,N=o.reduce((C,j)=>C+(j.montant||0),0),y=d*u.prixPinte+b*u.prixPichet+l*u.prixGobelet,h=C=>C<=u.seuilPerte?"ok":C<=u.seuilPerte*1.5?"attention":"alerte";return{barId:t.id,barNom:t.nom,type:t.type,futsVides:r,volumeSorti:a,pintes:d,pichets:b,gobelets:l,volumeVendu:g,ecartVolume:i,tauxPerte:x,statutPerte:h(x),caDeclare:N,caTheorique:y,ecartCa:N-y,ratioParFut:r>0?N/r:0}}),wt=(e=c)=>O.map(t=>{const s=S.filter(l=>!l.annule&&l.jour===e&&l.creneau===t.id),n=s.reduce((l,g)=>l+(g.nbPintes||0),0),r=s.reduce((l,g)=>l+(g.nbPichets||0),0),a=s.reduce((l,g)=>l+(g.nbGobelets||0),0),o=n*u.volumePinte+r*u.volumePichet,d=s.reduce((l,g)=>l+(g.montant||0),0),b=n*u.prixPinte+r*u.prixPichet+a*u.prixGobelet;return{creneauId:t.id,creneauLabel:t.label,nbTransactions:s.length,pintes:n,pichets:r,gobelets:a,volumeVendu:o,caDeclare:d,caTheorique:b,ecartCa:d-b,coherenceCa:b>0?d/b*100:100}}),Ua=()=>{const e=ns(),t=yt(),s=je(),n=De(),r=wt(),a=e.totalVentesJour,o=[...n].sort((f,L)=>L.caDeclare-f.caDeclare),d=s.total.futsVides,b=s.biere.futsVides,l=s.cidre.futsVides,g=$.filter(f=>!f.annule&&f.jour===c&&f.type==="RETOUR_VIDE");let i=0,x=0;g.forEach(f=>{const L=$.find(G=>!G.annule&&G.jour===c&&G.type==="SORTIE"&&G.barId===f.barId&&G.timestamp<f.timestamp);L&&(i+=f.timestamp-L.timestamp,x++)});const N=x>0?i/x:0,y=Math.floor(N/(1e3*60*60)),h=Math.floor(N%(1e3*60*60)/(1e3*60)),C=N>0?`${y}h${h.toString().padStart(2,"0")}`:"-",j=s.total.tauxPerte,B=n.filter(f=>f.futsVides>0),Z=B.length>0?B.reduce((f,L)=>L.ratioParFut>f.ratioParFut?L:f,B[0]):null,ne=r.reduce((f,L)=>L.caDeclare>f.caDeclare?L:f,r[0]),ee=[];for(let f=1;f<=c;f++){const G=S.filter(Fe=>!Fe.annule&&Fe.jour===f).reduce((Fe,Ct)=>Fe+(Ct.montant||0),0);ee.push({jour:f,ca:G})}return{caTotal:a,comparaison:t,classementBars:o,futsConsommes:d,futsBiere:b,futsCidre:l,dureeMoyenne:C,tauxPerteGlobal:j,statutPerte:s.total.statutPerte,manqueAGagner:s.total.manqueAGagner,barPlusRentable:Z,picActivite:ne,progressionFestival:ee}},rs=()=>{const e=[];for(let n=1;n<=u.nombreJours;n++){const r=S.filter(i=>!i.annule&&i.jour===n),a=r.reduce((i,x)=>i+(x.montant||0),0),o=je(n),d=De(n),b=d.length>0?d.reduce((i,x)=>x.caDeclare>i.caDeclare?x:i,d[0]):null,l=O.map(i=>{const x=r.filter(N=>N.creneau===i.id);return{creneau:i.label,ca:x.reduce((N,y)=>N+(y.montant||0),0)}}),g=l.reduce((i,x)=>x.ca>i.ca?x:i,l[0]);e.push({jour:n,ca:a,futsBiere:o.biere.futsVides,futsCidre:o.cidre.futsVides,tauxPerte:o.total.tauxPerte,topBar:(b==null?void 0:b.barNom)||"-",topBarCa:(b==null?void 0:b.caDeclare)||0,picCreneau:g.creneau,hasDonnees:a>0||o.total.futsVides>0})}const t=e.reduce((n,r)=>n+r.ca,0),s=e.reduce((n,r)=>n+r.futsBiere+r.futsCidre,0);return{jours:e,caTotal:t,futsTotal:s}},za=()=>{const t=$.filter(x=>!x.annule&&x.jour===c).filter(x=>x.type==="SORTIE"),s=x=>{if(!isFinite(x)||x>100)return null;const N=Math.floor(x),y=Math.round((x-N)*60);return N>0&&y>0?`${N}h${y.toString().padStart(2,"0")}`:N>0?`${N}h`:`${y}min`},n={biere:{rythme:"0.0",tempsRestant:null,alerte:!1},cidre:{rythme:"0.0",tempsRestant:null,alerte:!1}};if(t.length<2)return n;const r=Math.min(...t.map(x=>x.timestamp)),a=(Date.now()-r)/(1e3*60*60);if(a<.5)return n;const o=t.filter(x=>x.typeFut==="biere").length,d=t.filter(x=>x.typeFut==="cidre").length,b=o/a,l=d/a,g=b>0?ie/b:1/0,i=l>0?de/l:1/0;return{biere:{rythme:b.toFixed(1),tempsRestant:s(g),alerte:g<4},cidre:{rythme:l.toFixed(1),tempsRestant:s(i),alerte:i<4}}},un=()=>{const e={},t={};for(let s=10;s<=26;s++){const n=s>24?s-24:s;e[n]={sorties:0,retours:0}}return $.filter(s=>!s.annule&&s.jour===c).forEach(s=>{const n=new Date(s.timestamp).getHours();e[n]||(e[n]={sorties:0,retours:0}),s.type==="SORTIE"?e[n].sorties++:s.type.startsWith("RETOUR_")&&e[n].retours++,t[s.barId]||(t[s.barId]={}),t[s.barId][n]||(t[s.barId][n]={sorties:0,retours:0}),s.type==="SORTIE"?t[s.barId][n].sorties++:s.type.startsWith("RETOUR_")&&t[s.barId][n].retours++}),{statsParHeure:e,statsParBarEtHeure:t}},qs=()=>w.map(e=>{const t=S.filter(o=>!o.annule&&o.barId===e.id).reduce((o,d)=>o+(d.montant||0),0),s=$.filter(o=>!o.annule&&o.barId===e.id&&o.type.startsWith("RETOUR_")).length,n=$.filter(o=>!o.annule&&o.barId===e.id&&o.type==="SORTIE"),r=$.filter(o=>!o.annule&&o.barId===e.id&&o.type.startsWith("RETOUR_"));let a=0;return r.length>0&&(a=r.reduce((d,b)=>{const l=n.find(g=>g.timestamp<b.timestamp);return l?d+(b.timestamp-l.timestamp):d},0)/r.length/(1e3*60*60)),{...e,chiffreAffaires:t,futsConsommes:s,rotationMoyenne:a}}).sort((e,t)=>t.chiffreAffaires-e.chiffreAffaires),Ha=()=>{const e=[],t=[10,11,12,13,14,15,16,17,18,19,20,21,22,23,0];for(const s of t){const n=$.filter(r=>r.annule||r.jour!==c?!1:new Date(r.timestamp).getHours()===s);e.push({heure:s,heureAffichage:s===0?"00":s.toString(),sorties:n.filter(r=>r.type==="SORTIE").length,retours:n.filter(r=>r.type.startsWith("RETOUR_")).length})}return e},Js=async()=>{!ut.trim()||!T||(await v.ref(`sessions/${p}/annonces`).push({message:ut.trim(),auteur:A,timestamp:Date.now(),jour:c}),Ps(""),Ss(!1),k("\u{1F4E2} Annonce envoy\xE9e"))},Ga=async e=>{T&&await v.ref(`sessions/${p}/annonces/${e}`).remove()},Ms=async()=>{await window.loadJsPDF();const{jsPDF:e}=window.jspdf,t=new e,s=S.filter(h=>!h.annule&&h.jour===c),n=$.filter(h=>!h.annule&&h.jour===c),r=S.filter(h=>!h.annule&&h.equipementDefaillant&&h.jour===c),a=s.reduce((h,C)=>h+(C.montant||0),0),o=yt(),d=je(),b=De();let l=20;t.setFontSize(20),t.setTextColor(220,38,38),t.text("HELLFEST 2026 - BILAN JOURNALIER",105,l,{align:"center"}),l+=10,t.setFontSize(14),t.setTextColor(0),t.text(`Jour ${c} - ${new Date().toLocaleDateString("fr-FR")}`,105,l,{align:"center"}),l+=15,t.setFontSize(16),t.setTextColor(16,185,129),t.text("RESUME DES VENTES",20,l),l+=10,t.setFontSize(12),t.setTextColor(0),t.text(`Total du jour: ${a.toFixed(2)} EUR`,25,l),l+=7,t.text(`Nombre de transactions: ${s.length}`,25,l),l+=7,t.text(`Ticket moyen: ${s.length>0?(a/s.length).toFixed(2):0} EUR`,25,l),l+=12,o&&(t.setFontSize(14),t.setTextColor(o.tendance==="hausse"?34:220,o.tendance==="hausse"?197:38,o.tendance==="hausse"?94:38),t.text(`COMPARAISON J${o.jour} vs J${o.jourMoins1}`,20,l),l+=8,t.setFontSize(11),t.setTextColor(0),t.text(`A ${o.heureComparaison}, comparaison avec hier a la meme heure :`,25,l),l+=6,t.text(`Ventes J${o.jour}: ${o.ventesJour.toFixed(2)} EUR vs J${o.jourMoins1}: ${o.ventesJMoins1.toFixed(2)} EUR`,25,l),l+=6,t.text(`Ecart: ${o.ecartVentes>=0?"+":""}${o.ecartVentes.toFixed(2)} EUR (${o.ecartVentes>=0?"+":""}${o.ecartPourcent}%)`,25,l),l+=6,t.text(`Futs sortis: ${o.futsJour} vs ${o.futsJMoins1} hier (${o.ecartFuts>=0?"+":""}${o.ecartFuts})`,25,l),l+=6,o.totalFinalJMoins1>0&&(t.text(`Total final J${o.jourMoins1}: ${o.totalFinalJMoins1.toFixed(2)} EUR`,25,l),l+=6),l+=6),t.setFontSize(14),t.setTextColor(0),t.text("Ventes par bar:",25,l),l+=7,qs().forEach((h,C)=>{const j=S.filter(B=>!B.annule&&B.barId===h.id&&B.jour===c).reduce((B,Z)=>B+(Z.montant||0),0);t.setFontSize(11),t.text(`${C+1}. ${h.nom} (${h.type}): ${j.toFixed(2)} EUR`,30,l),l+=6}),l+=10,t.setFontSize(16),t.setTextColor(147,51,234),t.text("MOUVEMENTS DE FUTS",20,l),l+=10,t.setFontSize(12),t.setTextColor(0);const i=n.filter(h=>h.type==="SORTIE").length,x=n.filter(h=>h.type==="RETOUR_VIDE").length,N=n.filter(h=>h.type==="RETOUR_CASSE").length,y=n.filter(h=>h.type==="RETOUR_REUTILISABLE").length;if(t.text(`Sorties: ${i}`,25,l),l+=7,t.text(`Retours vides: ${x}`,25,l),l+=7,t.text(`Retours casses: ${N}`,25,l),l+=7,t.text(`Futs non termines: ${y}`,25,l),l+=7,t.text(`Stock restant - Biere: ${ie} | Cidre: ${de}`,25,l),l+=15,d.total.futsVides>0){l>200&&(t.addPage(),l=20),t.setFontSize(16),t.setTextColor(234,88,12),t.text("ANALYSE DES ECARTS (PERTES)",20,l),l+=10,t.setFontSize(11),t.setTextColor(0),t.text("Controle Volume:",25,l),l+=7,t.text(" Biere Cidre Total",25,l),l+=6,t.text(`Volume sorti: ${d.biere.volumeSorti.toFixed(0)}L ${d.cidre.volumeSorti.toFixed(0)}L ${d.total.volumeSorti.toFixed(0)}L`,25,l),l+=6,t.text(`Volume vendu: ${d.biere.volumeVendu.toFixed(1)}L ${d.cidre.volumeVendu.toFixed(1)}L ${d.total.volumeVendu.toFixed(1)}L`,25,l),l+=6,t.text(`Ecart: ${d.biere.ecartVolume.toFixed(1)}L ${d.cidre.ecartVolume.toFixed(1)}L ${d.total.ecartVolume.toFixed(1)}L`,25,l),l+=6;const h=C=>C==="ok"?"OK":C==="attention"?"ATTENTION":"ALERTE";t.text(`Taux perte: ${d.biere.tauxPerte.toFixed(1)}% ${h(d.biere.statutPerte)} ${d.cidre.tauxPerte.toFixed(1)}% ${h(d.cidre.statutPerte)} ${d.total.tauxPerte.toFixed(1)}%`,25,l),l+=10,t.text("Controle CA:",25,l),l+=7,t.text(`CA declare: ${d.biere.caDeclare.toFixed(0)}EUR ${d.cidre.caDeclare.toFixed(0)}EUR ${d.total.caDeclare.toFixed(0)}EUR`,25,l),l+=6,t.text(`CA theorique: ${d.biere.caTheorique.toFixed(0)}EUR ${d.cidre.caTheorique.toFixed(0)}EUR ${d.total.caTheorique.toFixed(0)}EUR`,25,l),l+=6,t.text(`Ecart CA: ${d.biere.ecartCa>=0?"+":""}${d.biere.ecartCa.toFixed(0)}EUR ${d.cidre.ecartCa>=0?"+":""}${d.cidre.ecartCa.toFixed(0)}EUR ${d.total.ecartCa>=0?"+":""}${d.total.ecartCa.toFixed(0)}EUR`,25,l),l+=10,d.total.manqueAGagner>0&&(t.setTextColor(220,38,38),t.text(`Manque a gagner estime: ~${d.total.manqueAGagner.toFixed(0)} EUR`,25,l),l+=10),t.setTextColor(0),t.text("Ecarts par bar:",25,l),l+=7,b.forEach(C=>{const j=C.statutPerte==="ok"?"(OK)":C.statutPerte==="attention"?"(!)":"(ALERTE)";t.text(` ${C.barNom}: ${C.tauxPerte.toFixed(1)}% ${j} - ${C.caDeclare.toFixed(0)}EUR`,25,l),l+=6}),l+=5}return r.length>0&&(l>240&&(t.addPage(),l=20),t.setFontSize(16),t.setTextColor(234,88,12),t.text("INCIDENTS SIGNALES",20,l),l+=10,t.setFontSize(11),t.setTextColor(0),r.forEach(h=>{t.text(`- ${h.barNom} - Equip. ${h.numEquipement||"N/A"}: ${h.commentaire||"Pas de detail"}`,25,l),l+=6})),t.setFontSize(9),t.setTextColor(128),t.text(`Genere le ${new Date().toLocaleString("fr-FR")} - Session ${p}`,105,285,{align:"center"}),t},Xa=async()=>{(await Ms()).save(`Bilan_J${c}_${new Date().toISOString().split("T")[0]}.pdf`),k("\u{1F4C4} PDF export\xE9")},Ka=async()=>{await window.loadXLSX();const e=je(),t=De(),s=wt(),n=rs(),r=[["HELLFEST 2026 - BILAN JOURNALIER"],[`Jour ${c} - ${new Date().toLocaleDateString("fr-FR")}`],[],["R\xC9SUM\xC9 DES VENTES"],["Total du jour",e.total.caDeclare.toFixed(2)+" \u20AC"],["Nombre de transactions",S.filter(f=>!f.annule&&f.jour===c).length],[],["F\xDBTS CONSOMM\xC9S"],["Bi\xE8re",e.biere.futsVides],["Cidre",e.cidre.futsVides],["Total",e.total.futsVides],[],["STOCK RESTANT"],["Bi\xE8re",ie],["Cidre",de]],a=[["ANALYSE DES \xC9CARTS - VOLUMES"],[],["","Bi\xE8re","Cidre","Total"],["F\xFBts vides",e.biere.futsVides,e.cidre.futsVides,e.total.futsVides],["Volume sorti (L)",e.biere.volumeSorti,e.cidre.volumeSorti,e.total.volumeSorti],["Pintes vendues",e.biere.pintes,e.cidre.pintes,e.biere.pintes+e.cidre.pintes],["Pichets vendus",e.biere.pichets,e.cidre.pichets,e.biere.pichets+e.cidre.pichets],["Volume vendu (L)",e.biere.volumeVendu.toFixed(1),e.cidre.volumeVendu.toFixed(1),e.total.volumeVendu.toFixed(1)],["\xC9cart volume (L)",e.biere.ecartVolume.toFixed(1),e.cidre.ecartVolume.toFixed(1),e.total.ecartVolume.toFixed(1)],["Taux de perte (%)",e.biere.tauxPerte.toFixed(1),e.cidre.tauxPerte.toFixed(1),e.total.tauxPerte.toFixed(1)],[],["CONTR\xD4LE CA"],["CA d\xE9clar\xE9 (\u20AC)",e.biere.caDeclare.toFixed(2),e.cidre.caDeclare.toFixed(2),e.total.caDeclare.toFixed(2)],["CA th\xE9orique (\u20AC)",e.biere.caTheorique.toFixed(2),e.cidre.caTheorique.toFixed(2),e.total.caTheorique.toFixed(2)],["\xC9cart CA (\u20AC)",e.biere.ecartCa.toFixed(2),e.cidre.ecartCa.toFixed(2),e.total.ecartCa.toFixed(2)],["Manque \xE0 gagner (\u20AC)",e.biere.manqueAGagner.toFixed(2),e.cidre.manqueAGagner.toFixed(2),e.total.manqueAGagner.toFixed(2)]],d=[["\xC9CARTS PAR BAR"],[],["Bar","Type","F\xFBts","Vol. sorti (L)","Vol. vendu (L)","\xC9cart (L)","Taux perte (%)","CA (\u20AC)","CA/f\xFBt (\u20AC)"],...t.map(f=>[f.barNom,f.type,f.futsVides,f.volumeSorti,f.volumeVendu.toFixed(1),f.ecartVolume.toFixed(1),f.tauxPerte.toFixed(1),f.caDeclare.toFixed(2),f.ratioParFut.toFixed(2)])],l=[["VENTES PAR CR\xC9NEAU"],[],["Cr\xE9neau","Pintes","Pichets","Gobelets","CA d\xE9clar\xE9 (\u20AC)","CA th\xE9orique (\u20AC)","\xC9cart (\u20AC)"],...s.map(f=>[f.creneauLabel,f.pintes,f.pichets,f.gobelets,f.caDeclare.toFixed(2),f.caTheorique.toFixed(2),f.ecartCa.toFixed(2)])],g=["",...n.jours.map(f=>`J${f.jour}`)],i=[["COMPARATIF FESTIVAL"],[],g,["CA (\u20AC)",...n.jours.map(f=>f.hasDonnees?f.ca.toFixed(2):"-")],["F\xFBts bi\xE8re",...n.jours.map(f=>f.hasDonnees?f.futsBiere:"-")],["F\xFBts cidre",...n.jours.map(f=>f.hasDonnees?f.futsCidre:"-")],["Taux perte (%)",...n.jours.map(f=>f.hasDonnees?f.tauxPerte.toFixed(1):"-")],["Top bar",...n.jours.map(f=>f.hasDonnees?f.topBar:"-")],[],["TOTAUX"],["CA Total",n.caTotal.toFixed(2)+" \u20AC"],["F\xFBts Total",n.futsTotal]],x=["Date/Heure","Bar","Cr\xE9neau","Pintes","Pichets","Gobelets","Montant (\u20AC)","\xC9quip. d\xE9faillant","Commentaire"],N=S.filter(f=>!f.annule&&f.jour===c),y=[["HISTORIQUE DES VENTES - JOUR "+c],[],x,...N.map(f=>{var L;return[new Date(f.timestamp).toLocaleString("fr-FR"),f.barNom||"-",((L=O.find(G=>G.id===f.creneau))==null?void 0:L.label)||"-",f.nbPintes||0,f.nbPichets||0,f.nbGobelets||0,(f.montant||0).toFixed(2),f.equipementDefaillant?"Oui":"Non",f.commentaire||""]})],h=XLSX.utils.book_new(),C=XLSX.utils.aoa_to_sheet(r),j=XLSX.utils.aoa_to_sheet(a),B=XLSX.utils.aoa_to_sheet(d),Z=XLSX.utils.aoa_to_sheet(l),ne=XLSX.utils.aoa_to_sheet(i),ee=XLSX.utils.aoa_to_sheet(y);XLSX.utils.book_append_sheet(h,C,"R\xE9sum\xE9"),XLSX.utils.book_append_sheet(h,j,"Analyse \xC9carts"),XLSX.utils.book_append_sheet(h,B,"\xC9carts par Bar"),XLSX.utils.book_append_sheet(h,Z,"Ventes par Cr\xE9neau"),XLSX.utils.book_append_sheet(h,ne,"Comparatif Festival"),XLSX.utils.book_append_sheet(h,ee,"Historique Ventes"),XLSX.writeFile(h,`Hellfest_J${c}_${new Date().toISOString().split("T")[0]}.xlsx`),k("\u{1F4CA} Excel export\xE9")};return p?React.createElement("div",{className:"min-h-screen bg-black text-white"},Ut&&React.createElement("div",{className:`fixed top-4 left-1/2 transform -translate-x-1/2 z-[100] px-6 py-3 rounded-xl shadow-lg animate-pulse ${Ut.type==="error"?"bg-red-600":"bg-green-600"}`},React.createElement("p",{className:"font-medium text-white"},Ut.message)),Fs.length>0&&React.createElement("div",{className:"bg-blue-900 border-b border-blue-700"},Fs.slice(0,1).map(e=>React.createElement("div",{key:e.id,className:"px-4 py-2 flex items-center justify-between"},React.createElement("div",{className:"flex items-center gap-2 flex-1"},React.createElement("span",{className:"text-xl"},"\u{1F4E2}"),React.createElement("div",{className:"flex-1"},React.createElement("p",{className:"text-sm font-medium"},e.message),React.createElement("p",{className:"text-xs text-blue-300"},e.user," \u2022 ",new Date(e.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})))),T&&React.createElement("button",{onClick:()=>Ga(e.id),className:"text-blue-300 hover:text-white px-2"},"\u2715")))),(!re||Ce.length>0)&&React.createElement("div",{className:`px-4 py-2 text-center text-sm ${re?"bg-amber-900":"bg-red-900"}`},re?React.createElement("span",null,"\u23F3 Synchronisation de ",Ce.length," action(s) en attente..."):React.createElement("span",null,"\u26A0\uFE0F Mode hors-ligne - Les actions seront synchronis\xE9es au retour du r\xE9seau")),React.createElement("div",{className:"bg-neutral-900 border-b border-red-900 p-3"},React.createElement("div",{className:"flex items-center justify-between mb-2"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("img",{src:"logo-hellfest.png",alt:"Hellfest",className:"w-10 h-10"}),React.createElement("div",null,React.createElement("h1",{className:"font-bold text-green-400"},"HELLFEST 2026"),React.createElement("p",{className:"text-xs text-neutral-400"},"Gestion des F\xFBts"))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("div",{className:`w-2 h-2 rounded-full ${re?"bg-green-500":"bg-red-500"}`}),React.createElement("button",{onClick:()=>lt(!0),className:"text-xs bg-neutral-800 px-2 py-1 rounded"},p))),React.createElement("div",{className:"flex items-center justify-between gap-2 mb-3"},React.createElement("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${D?"bg-red-900":"bg-neutral-800"}`},React.createElement("span",{className:"text-sm"},"Jour"),React.createElement("button",{onClick:()=>Xe("jour_prev"),disabled:D&&c<=1,className:"w-8 h-8 bg-neutral-700 rounded disabled:opacity-50"},"\u25C0"),React.createElement("span",{className:"text-xl font-bold w-8 text-center"},c),React.createElement("button",{onClick:()=>Xe("jour_next"),disabled:D&&c>=u.nombreJours,className:"w-8 h-8 bg-neutral-700 rounded disabled:opacity-50"},"\u25B6"),React.createElement("span",{className:"text-xs text-neutral-400"},"/",u.nombreJours)),React.createElement("button",{onClick:()=>{T||(D?pe(!1):Xe("parametres"))},className:`px-3 py-2 rounded-lg text-sm font-medium ${T?"bg-red-600 cursor-default opacity-90":D?"bg-green-600":"bg-neutral-800"}`},T?"\u{1F451} Super Admin":D?"\u{1F513} Admin":"\u{1F512} Admin")),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{onClick:Va,className:"flex-1 py-2 bg-indigo-600 rounded-lg text-sm font-medium flex items-center justify-center gap-1"},"\u{1F465} B\xE9n\xE9voles ",ue>0&&React.createElement("span",{className:"bg-white/20 px-1.5 rounded"},ue)),React.createElement("button",{onClick:()=>rt(!0),className:"flex-1 py-2 bg-emerald-600 rounded-lg text-sm font-medium"},"\u{1F4B0} Ventes"),D&&React.createElement(React.Fragment,null,React.createElement("button",{onClick:()=>Ns(!0),className:"py-2 px-3 bg-amber-600 rounded-lg text-sm font-medium"},"\u{1F4C8} Stats"),React.createElement("button",{onClick:()=>M(!I),className:`py-2 px-3 rounded-lg text-sm ${I?"bg-teal-500":"bg-teal-700"}`},"\u{1F4CA} ",S.length),React.createElement("button",{onClick:()=>q(!V),className:`py-2 px-3 rounded-lg text-sm ${V?"bg-purple-500":"bg-purple-700"}`},"\u{1F4CB} ",$.length)),T&&React.createElement("button",{onClick:()=>Ss(!Kt),className:`py-2 px-3 rounded-lg text-sm ${Kt?"bg-blue-500":"bg-blue-700"}`},"\u{1F4E2}"),React.createElement("button",{onClick:()=>Xe("export"),className:"py-2 px-3 bg-green-700 rounded-lg text-sm"},"\u{1F4E5}"),React.createElement("button",{onClick:()=>Xe("parametres"),className:"py-2 px-3 bg-neutral-700 rounded-lg text-sm"},"\u2699\uFE0F")),Kt&&T&&React.createElement("div",{className:"mt-2 flex gap-2"},React.createElement("input",{type:"text",value:ut,onChange:e=>Ps(e.target.value),placeholder:"Votre message \xE0 tous...",className:"flex-1 px-3 py-2 bg-neutral-800 rounded-lg text-sm",onKeyDown:e=>e.key==="Enter"&&Js()}),React.createElement("button",{onClick:Js,disabled:!ut.trim(),className:"px-4 py-2 bg-blue-600 rounded-lg text-sm disabled:opacity-50"},"\u{1F4E2} Envoyer"))),React.createElement("div",{className:`grid ${D?"grid-cols-5":"grid-cols-3"} gap-1 p-2 bg-neutral-900`},D&&React.createElement("div",{className:"bg-amber-900/50 p-2 rounded text-center"},React.createElement("div",{className:"text-lg font-bold text-amber-400"},ie),React.createElement("div",{className:"text-xs text-amber-200"},"\u{1F37A} Bi\xE8re")),D&&React.createElement("div",{className:"bg-orange-900/50 p-2 rounded text-center"},React.createElement("div",{className:"text-lg font-bold text-orange-400"},de),React.createElement("div",{className:"text-xs text-orange-200"},"\u{1F34E} Cidre")),React.createElement("div",{className:"bg-blue-900/50 p-2 rounded text-center"},React.createElement("div",{className:"text-lg font-bold text-blue-400"},Na),React.createElement("div",{className:"text-xs text-blue-200"},"Vides")),React.createElement("div",{className:"bg-red-900/50 p-2 rounded text-center"},React.createElement("div",{className:"text-lg font-bold text-red-400"},ha),React.createElement("div",{className:"text-xs text-red-200"},"Cass\xE9")),React.createElement("div",{className:"bg-purple-900/50 p-2 rounded text-center"},React.createElement("div",{className:"text-lg font-bold text-purple-400"},ya),React.createElement("div",{className:"text-xs text-purple-200"},"R\xE9util."))),ye.filter(e=>e.jourOrigine===c).length>0&&React.createElement("div",{className:"mx-2 mt-2 p-3 bg-purple-900/30 rounded-lg border border-purple-700 flex items-center justify-between"},React.createElement("span",{className:"text-purple-300"},"\u267B\uFE0F F\xFBts non termin\xE9s aujourd'hui"),React.createElement("span",{className:"text-lg font-bold text-purple-400"},ye.filter(e=>e.jourOrigine===c).length)),ye.filter(e=>e.jourOrigine<c).length>0&&React.createElement("div",{className:"mx-2 mt-2 bg-purple-900/50 rounded-xl border-2 border-purple-500 overflow-hidden"},React.createElement("div",{className:"bg-purple-800 px-3 py-2"},React.createElement("span",{className:"font-bold text-purple-100"},"\u26A0\uFE0F F\xFBts \xE0 reprendre en PRIORIT\xC9 (",ye.filter(e=>e.jourOrigine<c).length,")")),React.createElement("div",{className:"p-2 space-y-2"},ye.filter(e=>e.jourOrigine<c).map(e=>React.createElement("div",{key:e.id,className:"bg-purple-900/30 rounded-lg p-3 flex items-center justify-between"},React.createElement("div",null,React.createElement("span",{className:"font-medium"},e.typeFut==="biere"?"\u{1F37A}":"\u{1F34E}"," Non termin\xE9 du J",e.jourOrigine),React.createElement("p",{className:"text-xs text-purple-300"},"Venant de : ",e.barNom)),React.createElement("select",{onChange:t=>{t.target.value&&(Pa(e.id,t.target.value),t.target.value="")},className:"px-3 py-2 bg-purple-700 rounded-lg text-sm"},React.createElement("option",{value:""},"Attribuer \xE0..."),w.filter(t=>{var s;return t.type===e.typeFut&&(((s=t.futs)==null?void 0:s.length)||0)<u.maxFutsParBar}).map(t=>React.createElement("option",{key:t.id,value:t.id},t.nom))))))),js>0&&React.createElement("div",{className:"mx-2 mt-2 p-3 bg-emerald-900/50 rounded-lg flex items-center justify-between"},React.createElement("span",{className:"text-emerald-300"},"\u{1F4B0} Total Ventes"),React.createElement("span",{className:"text-xl font-bold text-emerald-400"},js.toFixed(2)," \u20AC")),D&&I&&React.createElement("div",{className:"mx-2 mt-2 bg-teal-900/30 rounded-xl border border-teal-700 overflow-hidden"},React.createElement("div",{className:"bg-teal-900/50 px-3 py-2 flex items-center justify-between"},React.createElement("span",{className:"font-bold text-teal-300"},"\u{1F4CA} Historique Ventes (",as.length,"/",S.length,")"),React.createElement("button",{onClick:()=>M(!1),className:"text-teal-400"},"\u2715")),React.createElement("div",{className:"px-3 py-2 bg-teal-900/30 border-b border-teal-800 flex flex-wrap gap-2"},React.createElement("select",{value:Ht,onChange:e=>na(e.target.value),className:"px-2 py-1 bg-teal-800 rounded text-sm"},React.createElement("option",{value:"tous"},"Tous les jours"),Array.from({length:u.nombreJours},(e,t)=>React.createElement("option",{key:t+1,value:t+1},"J",t+1," (",S.filter(s=>s.jour===t+1).length,")"))),React.createElement("input",{type:"text",value:Xt,onChange:e=>la(e.target.value),placeholder:"\u{1F50D} Rechercher...",className:"flex-1 px-2 py-1 bg-teal-800 rounded text-sm min-w-[120px]"})),React.createElement("div",{className:"max-h-64 overflow-y-auto"},as.length===0?React.createElement("p",{className:"text-neutral-500 text-sm text-center py-4"},"Aucune vente"):as.map(e=>React.createElement("div",{key:e.id,className:`px-3 py-2 border-b border-teal-800 last:border-0 ${e.annule?"opacity-50 bg-red-900/20":""}`},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:`font-medium ${e.annule?"line-through text-red-400":"text-teal-300"}`},(e.montant||0).toFixed(2)," \u20AC"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:`text-xs px-1.5 py-0.5 rounded ${Ts(e.barId)}`},e.barNom),!e.annule&&React.createElement("button",{onClick:()=>ja(e.id),className:"text-xs text-red-400 hover:text-red-300 px-1",title:"Annuler cette vente"},"\u2715"))),React.createElement("div",{className:"flex items-center justify-between text-xs text-neutral-500"},React.createElement("span",{className:e.annule?"line-through":""},"\u{1F37A}",e.nbPintes||0," \u{1F376}",e.nbPichets||0," \u{1F964}",e.nbGobelets||0),React.createElement("span",null,"J",e.jour," \u2022 ",new Date(e.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})," \u2022 ",e.user)),e.annule&&React.createElement("div",{className:"mt-1 text-xs text-red-400"},"\u274C Annul\xE9 par ",e.annulePar," le ",new Date(e.annuleLe).toLocaleString("fr-FR")),!e.annule&&e.equipementDefaillant&&React.createElement("div",{className:"mt-1 text-xs text-orange-400 bg-orange-900/30 px-2 py-1 rounded"},"\u26A0\uFE0F \xC9quip. d\xE9faillant",e.numEquipement?` - N\xB0${e.numEquipement}`:"",e.donneesPartielles?" (donn\xE9es partielles)":""))))),D&&V&&React.createElement("div",{className:"mx-2 mt-2 bg-purple-900/30 rounded-xl border border-purple-700 overflow-hidden"},React.createElement("div",{className:"bg-purple-900/50 px-3 py-2 flex items-center justify-between"},React.createElement("span",{className:"font-bold text-purple-300"},"\u{1F4CB} Historique F\xFBts (",ss.length,"/",$.length,")"),React.createElement("button",{onClick:()=>q(!1),className:"text-purple-400"},"\u2715")),React.createElement("div",{className:"px-3 py-2 bg-purple-900/30 border-b border-purple-800 flex flex-wrap gap-2"},React.createElement("select",{value:zt,onChange:e=>aa(e.target.value),className:"px-2 py-1 bg-purple-800 rounded text-sm"},React.createElement("option",{value:"tous"},"Tous les jours"),Array.from({length:u.nombreJours},(e,t)=>React.createElement("option",{key:t+1,value:t+1},"J",t+1," (",$.filter(s=>s.jour===t+1).length,")"))),React.createElement("input",{type:"text",value:Gt,onChange:e=>ra(e.target.value),placeholder:"\u{1F50D} Rechercher...",className:"flex-1 px-2 py-1 bg-purple-800 rounded text-sm min-w-[120px]"})),React.createElement("div",{className:"max-h-64 overflow-y-auto"},ss.length===0?React.createElement("p",{className:"text-neutral-500 text-sm text-center py-4"},"Aucun mouvement"):ss.map(e=>{const s={SORTIE:{icon:"\u{1F4E4}",label:"Sortie",color:"text-green-400"},RETOUR_VIDE:{icon:"\u{1F4E6}",label:"Vide",color:"text-blue-400"},RETOUR_CASSE:{icon:"\u{1F4A5}",label:"Cass\xE9",color:"text-red-400"},RETOUR_REUTILISABLE:{icon:"\u267B\uFE0F",label:"Non termin\xE9",color:"text-purple-400"},RETOUR_PLEIN:{icon:"\u{1F504}",label:"Plein (r\xE9int\xE9gr\xE9)",color:"text-green-400"},REPRISE:{icon:"\u{1F504}",label:"Reprise",color:"text-cyan-400"}}[e.type]||{icon:"\u2022",label:e.type,color:"text-neutral-400"};return React.createElement("div",{key:e.id,className:`px-3 py-2 border-b border-purple-800 last:border-0 ${e.annule?"opacity-50 bg-red-900/20":""}`},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:`font-medium ${e.annule?"line-through text-red-400":s.color}`},s.icon," ",s.label),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:`text-xs px-1.5 py-0.5 rounded ${Ts(e.barId)}`},e.barNom),!e.annule&&React.createElement("button",{onClick:()=>Da(e.id),className:"text-xs text-red-400 hover:text-red-300 px-1",title:"Annuler ce mouvement"},"\u2715"))),React.createElement("div",{className:"flex items-center justify-between text-xs text-neutral-500"},React.createElement("span",{className:e.annule?"line-through":""},e.typeFut==="biere"?"\u{1F37A}":"\u{1F34E}"," ",e.user),React.createElement("span",null,"J",e.jour," \u2022 ",new Date(e.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}))),e.commentaire&&!e.annule&&React.createElement("div",{className:"mt-1 text-xs text-yellow-400 bg-yellow-900/30 px-2 py-1 rounded"},"\u{1F4AC} ",e.commentaire),e.annule&&React.createElement("div",{className:"mt-1 text-xs text-red-400"},"\u274C Annul\xE9 par ",e.annulePar," le ",new Date(e.annuleLe).toLocaleString("fr-FR")))}))),React.createElement("div",{className:"p-2 space-y-2 pb-24"},w.length===0?React.createElement("div",{className:"text-center py-8 text-neutral-500"},React.createElement("p",null,"Aucun bar nomade configur\xE9"),React.createElement("p",{className:"text-sm"},"Allez dans \u2699\uFE0F Param\xE8tres pour en ajouter")):w.map(e=>{const t=e.type==="biere",s=e.futs||[],n=s.length<u.maxFutsParBar&&(t?ie>0:de>0),r=s.length>=u.maxFutsParBar,a=s.length/u.maxFutsParBar*100,o=r?"bg-red-500":s.length>=u.maxFutsParBar-1?"bg-yellow-500":"bg-green-500";return React.createElement("div",{key:e.id,className:`rounded-xl border-2 overflow-hidden ${r?"border-red-600 bg-red-950/20":t?"border-emerald-600 bg-emerald-950/30":"border-teal-600 bg-teal-950/30"}`},React.createElement("div",{className:`px-3 py-2 flex items-center justify-between ${r?"bg-red-900/50":t?"bg-emerald-900/50":"bg-teal-900/50"}`},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"text-xl"},t?"\u{1F37A}":"\u{1F34E}"),React.createElement("span",{className:"font-bold text-lg"},e.nom)),r&&React.createElement("span",{className:"px-3 py-1 bg-red-600 rounded-full text-xs font-bold"},"COMPLET")),React.createElement("div",{className:"px-3 py-3 border-b border-white/10"},React.createElement("div",{className:"flex items-center justify-center gap-1 mb-2"},Array.from({length:u.maxFutsParBar}).map((d,b)=>React.createElement("span",{key:b,className:`text-2xl ${b<s.length?"":"opacity-30 grayscale"}`},"\u{1F6E2}\uFE0F"))),React.createElement("div",{className:"text-center"},React.createElement("span",{className:`text-4xl font-black ${r?"text-red-400":s.length>0?"text-yellow-400":"text-green-400"}`},s.length),React.createElement("span",{className:"text-2xl text-neutral-400"},"/",u.maxFutsParBar),React.createElement("p",{className:"text-xs text-neutral-500 mt-1"},r?"\u26D4 Maximum atteint":s.length===0?"\u2705 Disponible":`\u26A0\uFE0F ${u.maxFutsParBar-s.length} place(s) restante(s)`)),React.createElement("div",{className:"mt-2 h-3 bg-neutral-700 rounded-full overflow-hidden"},React.createElement("div",{className:`h-full ${o} transition-all duration-300`,style:{width:`${a}%`}}))),React.createElement("div",{className:"p-3 space-y-2"},s.length===0?React.createElement("p",{className:"text-neutral-500 text-sm text-center py-2"},"Aucun f\xFBt attribu\xE9"):s.map((d,b)=>{const l=d.dateAttribution?Rs(d.dateAttribution):"bg-neutral-700",g=d.dateAttribution?new Date(d.dateAttribution):null,i=g?`${g.getDate().toString().padStart(2,"0")}/${(g.getMonth()+1).toString().padStart(2,"0")}`:"",x=g?`${g.getHours().toString().padStart(2,"0")}:${g.getMinutes().toString().padStart(2,"0")}`:"";return React.createElement("div",{key:d.id||b,className:`flex items-center justify-between p-2 rounded-lg ${l}`},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"text-sm"},t?"\u{1F37A}":"\u{1F34E}"," F\xFBt ",b+1),g&&React.createElement("span",{className:"text-xs opacity-75"},"\u2022 ",i," ",x)),React.createElement("button",{onClick:()=>st({barId:e.id,futIndex:b,barNom:e.nom}),className:"px-3 py-1 bg-black/30 hover:bg-black/50 rounded text-sm"},"\u21A9\uFE0F Retour"))})))})),Ft&&React.createElement("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-sm p-6"},React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u{1F510} Authentification"),React.createElement("input",{type:"password",autoFocus:!0,value:Ae,onChange:e=>et(e.target.value),placeholder:"Mot de passe Admin ou Super Admin",className:"w-full px-4 py-3 bg-neutral-800 rounded-lg mb-2",onKeyDown:e=>{e.key==="Enter"&&Ds()}}),React.createElement("p",{className:"text-xs text-neutral-500 mb-4"},"\u{1F4A1} Le mot de passe Super Admin donne un acc\xE8s complet"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{type:"button",onClick:()=>Pe(!1),className:"flex-1 py-3 bg-neutral-700 rounded-lg"},"Annuler"),React.createElement("button",{type:"button",onClick:()=>Ds(),className:"flex-1 py-3 bg-red-600 rounded-lg font-medium"},"Valider")))),z&&React.createElement("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-sm p-6"},React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u21A9\uFE0F Retour de F\xFBt"),React.createElement("p",{className:"text-neutral-400 mb-4"},z.barNom),$t==="choix"&&React.createElement("div",{className:"space-y-2"},React.createElement("button",{onClick:()=>vt(z.barId,z.futIndex,"RETOUR_VIDE"),className:"w-full py-3 bg-blue-600 rounded-lg"},"\u{1F4E6} F\xFBt Vide"),React.createElement("button",{onClick:()=>{St("RETOUR_CASSE"),be("commentaire")},className:"w-full py-3 bg-red-600 rounded-lg"},"\u{1F4A5} F\xFBt Cass\xE9 / Endommag\xE9"),React.createElement("button",{onClick:()=>vt(z.barId,z.futIndex,"RETOUR_REUTILISABLE"),className:"w-full py-3 bg-purple-600 rounded-lg"},"\u267B\uFE0F Non Termin\xE9 (reprendre demain)"),React.createElement("button",{onClick:()=>vt(z.barId,z.futIndex,"RETOUR_PLEIN"),className:"w-full py-3 bg-green-600 rounded-lg"},"\u{1F504} F\xFBt Plein (non utilis\xE9)"),React.createElement("button",{onClick:()=>{st(null),be("choix"),St(""),nt("")},className:"w-full py-3 bg-neutral-700 rounded-lg mt-4"},"Annuler")),$t==="commentaire"&&React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"bg-red-900/30 border border-red-700 rounded-lg p-3"},React.createElement("p",{className:"text-red-400 text-sm"},"\u26A0\uFE0F Commentaire obligatoire pour un f\xFBt cass\xE9/endommag\xE9")),React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"D\xE9crivez le probl\xE8me *"),React.createElement("textarea",{value:Pt,onChange:e=>nt(e.target.value),className:"w-full px-4 py-2 bg-neutral-800 rounded-lg",rows:"3",placeholder:"Ex: F\xFBt perc\xE9, valve cass\xE9e, chute...",autoFocus:!0})),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{be("choix"),nt("")},className:"flex-1 py-3 bg-neutral-700 rounded-lg"},"Retour"),React.createElement("button",{onClick:()=>{if(!Pt.trim()){alert("Le commentaire est obligatoire pour un f\xFBt cass\xE9");return}vt(z.barId,z.futIndex,at,Pt)},className:"flex-1 py-3 bg-red-600 rounded-lg font-medium"},"Confirmer"))))),Ws&&React.createElement("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-sm p-6 max-h-[90vh] overflow-y-auto"},React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u{1F4B0} Saisie Vente"),(()=>{var b,l,g;const e=(i,x)=>{const N=`J${c}_${i}_${x}`;return xs[N]?!0:S.some(y=>!y.annule&&y.jour===c&&y.barId===i&&y.creneau===x)},t=(i,x)=>{const N=`J${c}_${i}_${x}`;return!!xs[N]},s=(i,x)=>t(i,x)?!1:S.some(N=>!N.annule&&N.jour===c&&N.barId===i&&N.creneau===x),n=(i,x)=>S.filter(N=>!N.annule&&N.jour===c&&N.barId===i&&N.creneau===x),a=(()=>{for(const i of O)if(!w.every(N=>e(N.id,i.id)))return i;return null})(),o=[];O.forEach(i=>{w.forEach(x=>{if(s(x.id,i.id)){const N=n(x.id,i.id);o.push({barId:x.id,barNom:x.nom,barType:x.type,creneauId:i.id,creneauLabel:i.label,nbVentes:N.length,totalMontant:N.reduce((y,h)=>y+(h.montant||0),0)})}})});const d=a?w.filter(i=>!t(i.id,a.id)):[];return React.createElement("div",{className:"space-y-4"},o.length>0&&React.createElement("div",{className:"bg-orange-900/30 border border-orange-600 rounded-xl p-3"},React.createElement("p",{className:"text-xs text-orange-400 font-bold mb-2"},"\u26A0\uFE0F Saisie(s) partielle(s) - PAD remplac\xE9 :"),React.createElement("div",{className:"space-y-2 max-h-40 overflow-y-auto"},o.map((i,x)=>React.createElement("div",{key:x,className:"bg-neutral-800 rounded-lg p-2"},React.createElement("div",{className:"flex items-center justify-between mb-1"},React.createElement("span",{className:"text-sm text-orange-300"},i.barType==="biere"?"\u{1F37A}":"\u{1F34E}"," ",i.barNom," - ",i.creneauLabel),React.createElement("span",{className:"text-xs text-neutral-500"},i.nbVentes," PAD \u2022 ",i.totalMontant.toFixed(2),"\u20AC")),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{Ue(i.barId),ze(i.creneauId)},className:"flex-1 py-2 bg-blue-600 hover:bg-blue-500 rounded text-xs font-medium"},"\u2795 Ajouter donn\xE9es PAD"),React.createElement("button",{onClick:async()=>{if(!confirm(`Cl\xF4turer d\xE9finitivement ${i.barNom} - ${i.creneauLabel} ?

Total actuel : ${i.totalMontant.toFixed(2)}\u20AC (${i.nbVentes} PAD)`))return;const N=`J${c}_${i.barId}_${i.creneauId}`;await v.ref(`sessions/${p}/creneauxUtilises/${N}`).set({barId:i.barId,creneau:i.creneauId,jour:c,timestamp:Date.now(),user:A}),k(`\u2705 ${i.barNom} - ${i.creneauLabel} cl\xF4tur\xE9`)},className:"py-2 px-3 bg-green-600 hover:bg-green-500 rounded text-xs font-medium"},"\u{1F512} Cl\xF4turer")))))),a?React.createElement("div",{className:"bg-blue-900/30 border border-blue-600 rounded-xl p-3 text-center"},React.createElement("p",{className:"text-xs text-neutral-400"},"Cr\xE9neau en cours :"),React.createElement("p",{className:"text-2xl font-bold text-blue-400"},a.label),React.createElement("p",{className:"text-xs text-neutral-500 mt-1"},d.length," bar(s) \xE0 saisir")):React.createElement("div",{className:"bg-green-900/30 border border-green-600 rounded-xl p-4 text-center"},React.createElement("p",{className:"text-3xl mb-2"},"\u{1F389}"),React.createElement("p",{className:"text-green-400 font-bold"},"Tous les cr\xE9neaux trait\xE9s !"),o.length>0&&React.createElement("p",{className:"text-xs text-orange-400 mt-1"},"\u26A0\uFE0F ",o.length," cr\xE9neau(x) avec saisies partielles ci-dessus")),a&&!W&&React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"S\xE9lectionner un bar :"),React.createElement("div",{className:"grid grid-cols-2 gap-2"},w.map(i=>{const x=t(i.id,a.id),N=s(i.id,a.id),y=n(i.id,a.id);return React.createElement("button",{key:i.id,onClick:()=>{x||(Ue(i.id),ze(a.id))},disabled:x,className:`p-3 rounded-lg text-left text-sm ${x?"bg-green-900/30 text-green-400 cursor-not-allowed":N?"bg-orange-900/30 border border-orange-500 text-orange-300 hover:bg-orange-900/50":"bg-neutral-800 hover:bg-neutral-700"}`},React.createElement("span",null,i.type==="biere"?"\u{1F37A}":"\u{1F34E}"," ",i.nom),x&&React.createElement("span",{className:"block text-xs mt-1"},"\u2705 Cl\xF4tur\xE9"),N&&React.createElement("span",{className:"block text-xs mt-1"},"\u26A0\uFE0F ",y.length," PAD"))}))),W&&oe&&React.createElement("div",{className:"bg-neutral-800/50 rounded-xl p-4 border border-blue-500/30"},React.createElement("div",{className:"flex items-center justify-between mb-4"},React.createElement("div",null,React.createElement("p",{className:"font-bold text-blue-400"},((b=w.find(i=>i.id===W))==null?void 0:b.type)==="biere"?"\u{1F37A}":"\u{1F34E}"," ",(l=w.find(i=>i.id===W))==null?void 0:l.nom),React.createElement("p",{className:"text-sm text-neutral-400"},(g=O.find(i=>i.id===oe))==null?void 0:g.label)),React.createElement("button",{onClick:()=>{Ue(""),ze("")},className:"text-neutral-400 hover:text-white px-2 py-1"},"\u2715 Changer")),(()=>{const i=n(W,oe);return i.length>0?React.createElement("div",{className:"bg-orange-900/20 border border-orange-600/50 rounded-lg p-2 mb-4"},React.createElement("p",{className:"text-xs text-orange-400 mb-1"},"Saisies existantes (",i.length,") :"),React.createElement("div",{className:"space-y-1"},i.map((x,N)=>{var y;return React.createElement("div",{key:N,className:"text-xs text-neutral-400 flex justify-between"},React.createElement("span",null,"PAD ",x.numEquipement||"#"+(N+1)," ",x.equipementDefaillant?"\u26A0\uFE0F":""),React.createElement("span",null,(y=x.montant)==null?void 0:y.toFixed(2),"\u20AC"))}),React.createElement("div",{className:"border-t border-orange-600/30 pt-1 mt-1 text-xs font-bold text-orange-300 flex justify-between"},React.createElement("span",null,"Total"),React.createElement("span",null,i.reduce((x,N)=>x+(N.montant||0),0).toFixed(2),"\u20AC")))):null})(),React.createElement("div",{className:"space-y-3"},React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"Montant (\u20AC) ",React.createElement("span",{className:"text-red-400"},"*")),React.createElement("input",{type:"number",step:"0.01",value:us,onChange:i=>Et(i.target.value),className:"w-full px-4 py-3 bg-neutral-800 rounded-lg text-xl",placeholder:"0.00"})),React.createElement("div",{className:"grid grid-cols-3 gap-2"},React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Pintes *"),React.createElement("input",{type:"number",min:"0",value:Rt,onChange:i=>It(i.target.value),className:"w-full px-2 py-2 bg-neutral-800 rounded-lg text-center",placeholder:"0"})),React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Pichets *"),React.createElement("input",{type:"number",min:"0",value:Tt,onChange:i=>jt(i.target.value),className:"w-full px-2 py-2 bg-neutral-800 rounded-lg text-center",placeholder:"0"})),React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Gobelets *"),React.createElement("input",{type:"number",min:"0",value:Dt,onChange:i=>Vt(i.target.value),className:"w-full px-2 py-2 bg-neutral-800 rounded-lg text-center",placeholder:"0"}))),React.createElement("div",{className:"flex items-center gap-3"},React.createElement("input",{type:"checkbox",checked:Ie,onChange:i=>Lt(i.target.checked),className:"w-5 h-5 rounded accent-orange-500"}),React.createElement("span",{className:"text-orange-400 font-medium text-sm"},"\u26A0\uFE0F PAD d\xE9faillant (remplac\xE9)")),Ie&&React.createElement("div",{className:"bg-orange-900/20 border border-orange-500/30 rounded-lg p-3 space-y-2"},React.createElement("p",{className:"text-xs text-orange-300"},"Le cr\xE9neau restera ouvert pour ajouter les donn\xE9es du nouveau PAD"),React.createElement("input",{type:"text",value:ms,onChange:i=>Ot(i.target.value),placeholder:"N\xB0 PAD d\xE9faillant",className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"}),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("input",{type:"checkbox",checked:ps,onChange:i=>_t(i.target.checked),className:"w-4 h-4"}),React.createElement("span",{className:"text-orange-400 text-xs"},"Donn\xE9es partielles"))),React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Commentaire"),React.createElement("textarea",{value:cs,onChange:i=>Bt(i.target.value),className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm",rows:"2"})))))})(),React.createElement("div",{className:"flex gap-2 mt-6"},React.createElement("button",{onClick:()=>{rt(!1),Ue(""),ze(""),Et(""),It(""),jt(""),Vt(""),Lt(!1),Ot(""),_t(!1),Bt("")},className:"flex-1 py-3 bg-neutral-700 rounded-lg"},"Annuler"),React.createElement("button",{onClick:Aa,disabled:Y||!W||!oe,className:"flex-1 py-3 bg-emerald-600 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed"},Y?"\u23F3...":"\u2713 Enregistrer")))),F&&React.createElement("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-md p-6 max-h-[90vh] overflow-y-auto"},React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u2699\uFE0F Param\xE8tres"),React.createElement("div",{className:"space-y-4"},React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"Stock initial Bi\xE8re"),React.createElement("input",{type:"number",defaultValue:u.stockInitialBiere,id:"stockBiere",className:"w-full px-4 py-2 bg-neutral-800 rounded-lg"})),React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"Stock initial Cidre"),React.createElement("input",{type:"number",defaultValue:u.stockInitialCidre,id:"stockCidre",className:"w-full px-4 py-2 bg-neutral-800 rounded-lg"})),React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"Max f\xFBts par bar"),React.createElement("input",{type:"number",defaultValue:u.maxFutsParBar,id:"maxFuts",className:"w-full px-4 py-2 bg-neutral-800 rounded-lg"})),React.createElement("div",null,React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"Nombre de jours"),React.createElement("input",{type:"number",defaultValue:u.nombreJours,id:"nbJours",className:"w-full px-4 py-2 bg-neutral-800 rounded-lg"})),React.createElement("hr",{className:"border-neutral-700"}),React.createElement("div",null,React.createElement("h4",{className:"font-bold mb-2"},"Bars Nomades"),React.createElement("div",{className:"space-y-2 mb-4"},w.map(e=>React.createElement("div",{key:e.id,className:"flex items-center justify-between bg-neutral-800 p-2 rounded"},sa===e.id?React.createElement("div",{className:"flex items-center gap-2 flex-1"},React.createElement("span",null,e.type==="biere"?"\u{1F37A}":"\u{1F34E}"),React.createElement("input",{type:"text",value:Mt,onChange:t=>gs(t.target.value),className:"flex-1 px-2 py-1 bg-neutral-700 rounded text-sm",autoFocus:!0,onKeyDown:t=>{t.key==="Enter"?(Vs(e.id,Mt),He(null)):t.key==="Escape"&&He(null)}}),React.createElement("button",{onClick:()=>{Vs(e.id,Mt),He(null)},className:"text-green-400 text-sm px-2"},"\u2713"),React.createElement("button",{onClick:()=>He(null),className:"text-neutral-400 text-sm px-2"},"\u2715")):React.createElement(React.Fragment,null,React.createElement("span",null,e.type==="biere"?"\u{1F37A}":"\u{1F34E}"," ",e.nom),React.createElement("div",{className:"flex items-center gap-2"},T&&React.createElement("button",{onClick:()=>{He(e.id),gs(e.nom)},className:"text-blue-400 text-sm",title:"Renommer"},"\u270F\uFE0F"),React.createElement("button",{onClick:()=>$a(e.id),className:"text-red-400 text-sm"},"\u2715")))))),React.createElement("div",{className:"flex gap-2"},React.createElement("input",{type:"text",id:"newBarNom",placeholder:"Nom du bar",className:"flex-1 px-3 py-2 bg-neutral-800 rounded-lg text-sm"}),React.createElement("select",{id:"newBarType",className:"px-3 py-2 bg-neutral-800 rounded-lg text-sm"},React.createElement("option",{value:"biere"},"\u{1F37A} Bi\xE8re"),React.createElement("option",{value:"cidre"},"\u{1F34E} Cidre")),React.createElement("button",{onClick:()=>{const e=document.getElementById("newBarNom").value,t=document.getElementById("newBarType").value;e&&(Fa(e,t),document.getElementById("newBarNom").value="")},className:"px-4 py-2 bg-red-600 rounded-lg text-sm"},"+"))),T&&React.createElement(React.Fragment,null,React.createElement("hr",{className:"border-neutral-700"}),React.createElement("div",null,React.createElement("h4",{className:"font-bold mb-2"},"\u{1F4E7} Email bilan automatique"),React.createElement("p",{className:"text-xs text-neutral-400 mb-2"},"Recevez le bilan PDF \xE0 00h30 chaque jour"),React.createElement("input",{type:"email",id:"adminEmailInput",defaultValue:Ge,placeholder:"email@exemple.com",className:"w-full px-4 py-2 bg-neutral-800 rounded-lg text-sm"}),React.createElement("p",{className:"text-xs text-neutral-500 mt-2"},"\u{1F4A1} \xC0 00h30, le PDF sera g\xE9n\xE9r\xE9 et votre client mail s'ouvrira avec le bilan en lien.")),React.createElement("hr",{className:"border-neutral-700"}),React.createElement("div",null,React.createElement("h4",{className:"font-bold mb-3"},"\u{1F4B0} Tarifs"),React.createElement("div",{className:"grid grid-cols-3 gap-2"},React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Prix pinte (\u20AC)"),React.createElement("input",{type:"number",step:"0.5",id:"prixPinte",defaultValue:u.prixPinte,className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"})),React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Prix pichet (\u20AC)"),React.createElement("input",{type:"number",step:"0.5",id:"prixPichet",defaultValue:u.prixPichet,className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"})),React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Prix gobelet (\u20AC)"),React.createElement("input",{type:"number",step:"0.5",id:"prixGobelet",defaultValue:u.prixGobelet,className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"})))),React.createElement("hr",{className:"border-neutral-700"}),React.createElement("div",null,React.createElement("h4",{className:"font-bold mb-3"},"\u{1F6E2}\uFE0F Volumes"),React.createElement("div",{className:"grid grid-cols-2 gap-2 mb-3"},React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Vol. pinte (L)"),React.createElement("input",{type:"number",step:"0.1",id:"volumePinte",defaultValue:u.volumePinte,className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"})),React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Vol. pichet (L)"),React.createElement("input",{type:"number",step:"0.1",id:"volumePichet",defaultValue:u.volumePichet,className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"}))),React.createElement("div",{className:"grid grid-cols-2 gap-2"},React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Vol. f\xFBt bi\xE8re (L)"),React.createElement("input",{type:"number",step:"1",id:"volumeFutBiere",defaultValue:u.volumeFutBiere,className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"})),React.createElement("div",null,React.createElement("label",{className:"block text-xs text-neutral-400 mb-1"},"Vol. f\xFBt cidre (L)"),React.createElement("input",{type:"number",step:"1",id:"volumeFutCidre",defaultValue:u.volumeFutCidre,className:"w-full px-3 py-2 bg-neutral-800 rounded-lg text-sm"}))),React.createElement("p",{className:"text-xs text-neutral-500 mt-2"},"\u2139\uFE0F Gobelets = consommable, non comptabilis\xE9 dans les volumes")),React.createElement("hr",{className:"border-neutral-700"}),React.createElement("div",null,React.createElement("h4",{className:"font-bold mb-2"},"\u{1F4C9} Seuil alerte perte"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("input",{type:"number",step:"1",id:"seuilPerte",defaultValue:u.seuilPerte,className:"w-20 px-3 py-2 bg-neutral-800 rounded-lg text-sm"}),React.createElement("span",{className:"text-neutral-400"},"%")),React.createElement("p",{className:"text-xs text-neutral-500 mt-2"},"Taux de perte acceptable (mousse, rin\xE7age...)")))),React.createElement("div",{className:"flex gap-2 mt-6"},React.createElement("button",{onClick:()=>R(!1),className:"flex-1 py-3 bg-neutral-700 rounded-lg"},"Annuler"),React.createElement("button",{onClick:()=>{var t,s,n,r,a,o,d,b,l;const e=((t=document.getElementById("adminEmailInput"))==null?void 0:t.value)||"";e!==Ge&&(As(e),v.ref(`sessions/${p}/config/adminEmail`).set(e)),ka({stockInitialBiere:parseInt(document.getElementById("stockBiere").value)||50,stockInitialCidre:parseInt(document.getElementById("stockCidre").value)||20,maxFutsParBar:parseInt(document.getElementById("maxFuts").value)||3,nombreJours:parseInt(document.getElementById("nbJours").value)||4,prixPinte:parseFloat((s=document.getElementById("prixPinte"))==null?void 0:s.value)||6,prixPichet:parseFloat((n=document.getElementById("prixPichet"))==null?void 0:n.value)||15,prixGobelet:parseFloat((r=document.getElementById("prixGobelet"))==null?void 0:r.value)||2,volumePinte:parseFloat((a=document.getElementById("volumePinte"))==null?void 0:a.value)||.5,volumePichet:parseFloat((o=document.getElementById("volumePichet"))==null?void 0:o.value)||1.5,volumeFutBiere:parseFloat((d=document.getElementById("volumeFutBiere"))==null?void 0:d.value)||30,volumeFutCidre:parseFloat((b=document.getElementById("volumeFutCidre"))==null?void 0:b.value)||20,seuilPerte:parseFloat((l=document.getElementById("seuilPerte"))==null?void 0:l.value)||10})},className:"flex-1 py-3 bg-red-600 rounded-lg font-medium"},"\u{1F4BE} Sauvegarder")),D&&React.createElement("button",{onClick:()=>qt(!0),className:"w-full mt-4 py-3 bg-red-900 hover:bg-red-800 rounded-lg font-medium border border-red-600"},"\u{1F512} R\xE9initialiser (Admin)"))),ta&&React.createElement("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-red-950 rounded-2xl w-full max-w-md p-6 border border-red-700"},React.createElement("h3",{className:"text-xl font-bold mb-4 text-red-400"},"\u26A0\uFE0F R\xE9initialisation Admin"),React.createElement("div",{className:"bg-red-900/50 rounded-lg p-4 mb-4"},React.createElement("p",{className:"font-bold text-yellow-400 mb-2"},"\u26A0\uFE0F Suppression :"),React.createElement("ul",{className:"text-red-300 text-sm space-y-1 ml-4"},React.createElement("li",null,"\u2022 F\xFBts attribu\xE9s"),React.createElement("li",null,"\u2022 Historiques f\xFBts/ventes"),React.createElement("li",null,"\u2022 Affectations b\xE9n\xE9voles")),React.createElement("p",{className:"text-green-400 text-sm mt-3"},"La configuration des bars sera conserv\xE9e.")),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm text-neutral-400 mb-1"},"Mot de passe admin"),React.createElement("div",{className:"relative"},React.createElement("input",{type:"password",value:fs,onChange:e=>Jt(e.target.value),placeholder:"Mot de passe...",className:"w-full px-4 py-2 bg-neutral-800 rounded-lg"}))),React.createElement("div",{className:"space-y-2"},React.createElement("button",{onClick:()=>Bs(!0),className:"w-full py-3 bg-neutral-700 hover:bg-neutral-600 rounded-lg flex items-center justify-center gap-2"},"\u{1F4E5} Exporter puis r\xE9initialiser"),React.createElement("button",{onClick:()=>Bs(!1),className:"w-full py-3 bg-neutral-700 hover:bg-neutral-600 rounded-lg flex items-center justify-center gap-2"},"\u{1F5D1}\uFE0F R\xE9initialiser sans exporter")),React.createElement("button",{onClick:()=>{qt(!1),Jt("")},className:"w-full mt-4 py-3 bg-neutral-800 rounded-lg"},"Annuler"))),tt&&React.createElement("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-sm p-6"},React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u{1F4E5} Exporter"),React.createElement("div",{className:"space-y-2"},React.createElement("button",{onClick:()=>{Os(),xe(!1)},disabled:$.length===0,className:"w-full py-3 bg-purple-600 rounded-lg disabled:opacity-50"},"\u{1F4CB} Historique F\xFBts (",$.length,")"),React.createElement("button",{onClick:()=>{_s(),xe(!1)},disabled:S.length===0,className:"w-full py-3 bg-emerald-600 rounded-lg disabled:opacity-50"},"\u{1F4B0} Historique Ventes (",S.length,")"),React.createElement("button",{onClick:()=>{ts(),xe(!1)},disabled:ue===0,className:"w-full py-3 bg-indigo-600 rounded-lg disabled:opacity-50"},"\u{1F465} Planning B\xE9n\xE9voles (",ue,")"),React.createElement("button",{onClick:()=>xe(!1),className:"w-full py-3 bg-neutral-700 rounded-lg mt-4"},"Fermer")))),oa&&React.createElement("div",{className:"fixed inset-0 bg-black/90 flex flex-col z-50"},React.createElement("div",{className:"bg-amber-900 px-4 py-3 flex items-center justify-between"},React.createElement("h3",{className:"text-xl font-bold"},"\u{1F4C8} Dashboard J",c),React.createElement("div",{className:"flex items-center gap-2"},T&&React.createElement(React.Fragment,null,React.createElement("button",{onClick:Ka,className:"px-3 py-1 bg-green-600 rounded-lg text-sm"},"\u{1F4CA} Excel"),React.createElement("button",{onClick:Xa,className:"px-3 py-1 bg-red-600 rounded-lg text-sm"},"\u{1F4C4} PDF")),React.createElement("button",{onClick:()=>Ns(!1),className:"text-2xl"},"\u2715"))),React.createElement("div",{className:"bg-neutral-800 px-2 py-2 flex gap-1"},React.createElement("button",{onClick:()=>dt("synthese"),className:`flex-1 py-2 rounded-lg text-xs font-medium ${ve==="synthese"?"bg-amber-600":"bg-neutral-700"}`},"\u{1F4CA} Synth\xE8se"),React.createElement("button",{onClick:()=>dt("ecarts"),className:`flex-1 py-2 rounded-lg text-xs font-medium ${ve==="ecarts"?"bg-amber-600":"bg-neutral-700"}`},"\u{1F4C9} \xC9carts"),React.createElement("button",{onClick:()=>dt("graphiques"),className:`flex-1 py-2 rounded-lg text-xs font-medium ${ve==="graphiques"?"bg-amber-600":"bg-neutral-700"}`},"\u{1F4C8} Graphes"),React.createElement("button",{onClick:()=>dt("comparatif"),className:`flex-1 py-2 rounded-lg text-xs font-medium ${ve==="comparatif"?"bg-amber-600":"bg-neutral-700"}`},"\u{1F4C5} Jours")),React.createElement("div",{className:"flex-1 overflow-y-auto p-4"},ve==="synthese"&&(()=>{var o,d,b;const e=ns(),t=qs(),s=za(),n=Ha(),r=yt(),a=Ua();return React.createElement("div",{className:"space-y-4 max-w-2xl mx-auto"},React.createElement("div",{className:"grid grid-cols-2 gap-3"},React.createElement("div",{className:"bg-emerald-900/30 p-4 rounded-xl border border-emerald-700"},React.createElement("p",{className:"text-xs text-emerald-300"},"\u{1F4B0} CA Jour"),React.createElement("p",{className:"text-3xl font-black text-emerald-400"},a.caTotal.toFixed(0)," \u20AC")),a.comparaison?React.createElement("div",{className:`p-4 rounded-xl border ${a.comparaison.tendance==="hausse"?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700"}`},React.createElement("p",{className:"text-xs text-neutral-300"},"\u{1F4C8} vs J-1"),React.createElement("p",{className:`text-2xl font-black ${a.comparaison.tendance==="hausse"?"text-green-400":"text-red-400"}`},a.comparaison.tendance==="hausse"?"+":"",a.comparaison.ecartVentes.toFixed(0),"\u20AC"),React.createElement("p",{className:`text-sm ${a.comparaison.tendance==="hausse"?"text-green-400":"text-red-400"}`},a.comparaison.tendance==="hausse"?"\u25B2":"\u25BC"," ",Math.abs(a.comparaison.ecartPourcent),"%")):React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl border border-neutral-700"},React.createElement("p",{className:"text-xs text-neutral-400"},"\u{1F4C8} vs J-1"),React.createElement("p",{className:"text-lg text-neutral-500"},"J1 - Pas de comparaison")),React.createElement("div",{className:"bg-blue-900/30 p-4 rounded-xl border border-blue-700"},React.createElement("p",{className:"text-xs text-blue-300"},"\u{1F6E2}\uFE0F F\xFBts consomm\xE9s"),React.createElement("p",{className:"text-3xl font-black text-blue-400"},a.futsConsommes),React.createElement("p",{className:"text-xs text-neutral-400"},a.futsBiere,"\u{1F37A} + ",a.futsCidre,"\u{1F34E}")),React.createElement("div",{className:"bg-purple-900/30 p-4 rounded-xl border border-purple-700"},React.createElement("p",{className:"text-xs text-purple-300"},"\u23F1\uFE0F Dur\xE9e moy. f\xFBt"),React.createElement("p",{className:"text-3xl font-black text-purple-400"},a.dureeMoyenne)),React.createElement("div",{className:`p-4 rounded-xl border ${a.statutPerte==="ok"?"bg-green-900/30 border-green-700":a.statutPerte==="attention"?"bg-yellow-900/30 border-yellow-700":"bg-red-900/30 border-red-700"}`},React.createElement("p",{className:"text-xs text-neutral-300"},"\u{1F4C9} Taux perte"),React.createElement("p",{className:`text-3xl font-black ${a.statutPerte==="ok"?"text-green-400":a.statutPerte==="attention"?"text-yellow-400":"text-red-400"}`},a.tauxPerteGlobal.toFixed(1),"%",a.statutPerte==="ok"?" \u2713":a.statutPerte==="attention"?" \u26A0\uFE0F":" \u{1F534}"),a.manqueAGagner>0&&React.createElement("p",{className:"text-xs text-neutral-400"},"~",a.manqueAGagner.toFixed(0),"\u20AC manque")),React.createElement("div",{className:"bg-amber-900/30 p-4 rounded-xl border border-amber-700"},React.createElement("p",{className:"text-xs text-amber-300"},"\u{1F3AF} Meilleur ratio"),a.barPlusRentable?React.createElement(React.Fragment,null,React.createElement("p",{className:"text-lg font-bold text-amber-400"},a.barPlusRentable.barNom),React.createElement("p",{className:"text-xs text-neutral-400"},a.barPlusRentable.ratioParFut.toFixed(0),"\u20AC/f\xFBt")):React.createElement("p",{className:"text-neutral-500"},"-")),React.createElement("div",{className:"bg-orange-900/30 p-4 rounded-xl border border-orange-700"},React.createElement("p",{className:"text-xs text-orange-300"},"\u26A1 Pic activit\xE9"),React.createElement("p",{className:"text-lg font-bold text-orange-400"},((o=a.picActivite)==null?void 0:o.creneauLabel)||"-"),React.createElement("p",{className:"text-xs text-neutral-400"},((b=(d=a.picActivite)==null?void 0:d.caDeclare)==null?void 0:b.toFixed(0))||0,"\u20AC")),React.createElement("div",{className:"bg-teal-900/30 p-4 rounded-xl border border-teal-700"},React.createElement("p",{className:"text-xs text-teal-300"},"\u{1F4E6} Stock restant"),React.createElement("p",{className:"text-2xl font-black text-teal-400"},ie,"\u{1F37A} ",de,"\u{1F34E}"))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F3C6} Classement bars par CA"),React.createElement("div",{className:"space-y-2"},a.classementBars.slice(0,5).map((l,g)=>React.createElement("div",{key:l.barId,className:"flex items-center gap-3 bg-neutral-700/50 p-2 rounded-lg"},React.createElement("span",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${g===0?"bg-amber-500 text-black":g===1?"bg-neutral-400 text-black":g===2?"bg-amber-700":"bg-neutral-600"}`},g+1),React.createElement("div",{className:"flex-1"},React.createElement("p",{className:"font-medium"},l.type==="biere"?"\u{1F37A}":"\u{1F34E}"," ",l.barNom),React.createElement("p",{className:"text-xs text-neutral-400"},l.futsVides," f\xFBts \u2022 ",l.ratioParFut.toFixed(0),"\u20AC/f\xFBt")),React.createElement("div",{className:"text-right"},React.createElement("p",{className:"font-bold text-emerald-400"},l.caDeclare.toFixed(0)," \u20AC")))))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F4C8} Progression festival"),React.createElement("div",{className:"space-y-2"},a.progressionFestival.map((l,g)=>{const i=Math.max(...a.progressionFestival.map(y=>y.ca),1),x=l.ca/i*100,N=g>0&&a.progressionFestival[g-1].ca>0?((l.ca-a.progressionFestival[g-1].ca)/a.progressionFestival[g-1].ca*100).toFixed(0):null;return React.createElement("div",{key:l.jour,className:"flex items-center gap-3"},React.createElement("span",{className:`w-8 font-bold ${l.jour===c?"text-amber-400":"text-neutral-400"}`},"J",l.jour),React.createElement("div",{className:"flex-1 bg-neutral-700 rounded-full h-6 overflow-hidden"},React.createElement("div",{className:`h-full ${l.jour===c?"bg-amber-500":"bg-emerald-600"}`,style:{width:`${x}%`}})),React.createElement("div",{className:"w-28 text-right text-sm"},React.createElement("span",{className:"font-medium"},l.ca.toFixed(0)," \u20AC"),N&&React.createElement("span",{className:`ml-1 text-xs ${parseInt(N)>=0?"text-green-400":"text-red-400"}`},parseInt(N)>=0?"+":"",N,"%")))}))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F4CA} Activit\xE9 par heure"),React.createElement("div",{className:"space-y-1"},n.map(l=>{const g=Math.max(...n.map(i=>i.sorties+i.retours),1);return React.createElement("div",{key:l.heure,className:"flex items-center gap-2 text-xs"},React.createElement("span",{className:"w-12 text-neutral-400"},l.heureAffichage,"h"),React.createElement("div",{className:"flex-1 flex h-4 bg-neutral-700 rounded overflow-hidden"},React.createElement("div",{className:"bg-green-500",style:{width:`${l.sorties/g*100}%`}}),React.createElement("div",{className:"bg-blue-500",style:{width:`${l.retours/g*100}%`}})),React.createElement("span",{className:"w-16 text-right"},React.createElement("span",{className:"text-green-400"},"+",l.sorties),React.createElement("span",{className:"text-blue-400 ml-1"},"-",l.retours)))}))),React.createElement("div",{className:"bg-gradient-to-r from-amber-900/30 to-orange-900/30 p-4 rounded-xl border border-amber-700"},React.createElement("h4",{className:"font-bold mb-3"},"\u23F1\uFE0F Pr\xE9vision rupture stock"),React.createElement("div",{className:"grid grid-cols-2 gap-4"},React.createElement("div",null,React.createElement("p",{className:"text-sm text-amber-300"},"\u{1F37A} Bi\xE8re (",ie,")"),React.createElement("p",{className:"text-xl font-bold text-amber-400"},s.biere.tempsRestant||"-"),React.createElement("p",{className:"text-xs text-neutral-500"},s.biere.rythme," f\xFBts/h")),React.createElement("div",null,React.createElement("p",{className:"text-sm text-orange-300"},"\u{1F34E} Cidre (",de,")"),React.createElement("p",{className:"text-xl font-bold text-orange-400"},s.cidre.tempsRestant||"-"),React.createElement("p",{className:"text-xs text-neutral-500"},s.cidre.rythme," f\xFBts/h")))))})(),ve==="ecarts"&&(()=>{const e=je(),t=De(),s=wt(),n=a=>a==="ok"?"\u2705":a==="attention"?"\u26A0\uFE0F":"\u{1F534}",r=a=>a==="ok"?"text-green-400":a==="attention"?"text-yellow-400":"text-red-400";return React.createElement("div",{className:"space-y-4 max-w-2xl mx-auto"},React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-4"},"\u{1F4C9} Analyse des \xE9carts - J",c),React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"w-full text-sm"},React.createElement("thead",null,React.createElement("tr",{className:"border-b border-neutral-600"},React.createElement("th",{className:"text-left py-2"}),React.createElement("th",{className:"text-right py-2 px-2"},"\u{1F37A} Bi\xE8re"),React.createElement("th",{className:"text-right py-2 px-2"},"\u{1F34E} Cidre"),React.createElement("th",{className:"text-right py-2 px-2"},"Total"))),React.createElement("tbody",null,React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"F\xFBts vides"),React.createElement("td",{className:"text-right px-2"},e.biere.futsVides),React.createElement("td",{className:"text-right px-2"},e.cidre.futsVides),React.createElement("td",{className:"text-right px-2 font-bold"},e.total.futsVides)),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"Volume sorti"),React.createElement("td",{className:"text-right px-2"},e.biere.volumeSorti," L"),React.createElement("td",{className:"text-right px-2"},e.cidre.volumeSorti," L"),React.createElement("td",{className:"text-right px-2 font-bold"},e.total.volumeSorti," L")),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"Pintes vendues"),React.createElement("td",{className:"text-right px-2"},e.biere.pintes),React.createElement("td",{className:"text-right px-2"},e.cidre.pintes),React.createElement("td",{className:"text-right px-2"},e.biere.pintes+e.cidre.pintes)),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"Pichets vendus"),React.createElement("td",{className:"text-right px-2"},e.biere.pichets),React.createElement("td",{className:"text-right px-2"},e.cidre.pichets),React.createElement("td",{className:"text-right px-2"},e.biere.pichets+e.cidre.pichets)),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"Volume vendu"),React.createElement("td",{className:"text-right px-2"},e.biere.volumeVendu.toFixed(1)," L"),React.createElement("td",{className:"text-right px-2"},e.cidre.volumeVendu.toFixed(1)," L"),React.createElement("td",{className:"text-right px-2 font-bold"},e.total.volumeVendu.toFixed(1)," L")),React.createElement("tr",{className:"border-b border-neutral-700 bg-neutral-700/30"},React.createElement("td",{className:"py-2 font-bold"},"\xC9cart volume"),React.createElement("td",{className:"text-right px-2 font-bold"},e.biere.ecartVolume.toFixed(1)," L"),React.createElement("td",{className:"text-right px-2 font-bold"},e.cidre.ecartVolume.toFixed(1)," L"),React.createElement("td",{className:"text-right px-2 font-bold"},e.total.ecartVolume.toFixed(1)," L")),React.createElement("tr",{className:"border-b border-neutral-700 bg-neutral-700/30"},React.createElement("td",{className:"py-2 font-bold"},"Taux perte"),React.createElement("td",{className:`text-right px-2 font-bold ${r(e.biere.statutPerte)}`},e.biere.tauxPerte.toFixed(1),"% ",n(e.biere.statutPerte)),React.createElement("td",{className:`text-right px-2 font-bold ${r(e.cidre.statutPerte)}`},e.cidre.tauxPerte.toFixed(1),"% ",n(e.cidre.statutPerte)),React.createElement("td",{className:`text-right px-2 font-bold ${r(e.total.statutPerte)}`},e.total.tauxPerte.toFixed(1),"% ",n(e.total.statutPerte)))))),e.total.manqueAGagner>0&&React.createElement("div",{className:"mt-3 p-3 bg-red-900/30 rounded-lg border border-red-700"},React.createElement("p",{className:"text-sm text-red-300"},"\u{1F4B8} Manque \xE0 gagner estim\xE9 : ",React.createElement("span",{className:"font-bold"},"~",e.total.manqueAGagner.toFixed(0)," \u20AC")))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-4"},"\u{1F4B0} Contr\xF4le coh\xE9rence CA"),React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"w-full text-sm"},React.createElement("thead",null,React.createElement("tr",{className:"border-b border-neutral-600"},React.createElement("th",{className:"text-left py-2"}),React.createElement("th",{className:"text-right py-2 px-2"},"\u{1F37A} Bi\xE8re"),React.createElement("th",{className:"text-right py-2 px-2"},"\u{1F34E} Cidre"),React.createElement("th",{className:"text-right py-2 px-2"},"Total"))),React.createElement("tbody",null,React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"CA d\xE9clar\xE9"),React.createElement("td",{className:"text-right px-2"},e.biere.caDeclare.toFixed(2)," \u20AC"),React.createElement("td",{className:"text-right px-2"},e.cidre.caDeclare.toFixed(2)," \u20AC"),React.createElement("td",{className:"text-right px-2 font-bold"},e.total.caDeclare.toFixed(2)," \u20AC")),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"CA th\xE9orique*"),React.createElement("td",{className:"text-right px-2"},e.biere.caTheorique.toFixed(2)," \u20AC"),React.createElement("td",{className:"text-right px-2"},e.cidre.caTheorique.toFixed(2)," \u20AC"),React.createElement("td",{className:"text-right px-2 font-bold"},e.total.caTheorique.toFixed(2)," \u20AC")),React.createElement("tr",{className:"border-b border-neutral-700 bg-neutral-700/30"},React.createElement("td",{className:"py-2 font-bold"},"\xC9cart CA"),React.createElement("td",{className:`text-right px-2 font-bold ${e.biere.ecartCa>=0?"text-green-400":"text-red-400"}`},e.biere.ecartCa>=0?"+":"",e.biere.ecartCa.toFixed(2)," \u20AC"),React.createElement("td",{className:`text-right px-2 font-bold ${e.cidre.ecartCa>=0?"text-green-400":"text-red-400"}`},e.cidre.ecartCa>=0?"+":"",e.cidre.ecartCa.toFixed(2)," \u20AC"),React.createElement("td",{className:`text-right px-2 font-bold ${e.total.ecartCa>=0?"text-green-400":"text-red-400"}`},e.total.ecartCa>=0?"+":"",e.total.ecartCa.toFixed(2)," \u20AC")),React.createElement("tr",null,React.createElement("td",{className:"py-2 font-bold"},"Coh\xE9rence"),React.createElement("td",{className:`text-right px-2 font-bold ${e.biere.coherenceCa>=95?"text-green-400":e.biere.coherenceCa>=90?"text-yellow-400":"text-red-400"}`},e.biere.coherenceCa.toFixed(1),"%"),React.createElement("td",{className:`text-right px-2 font-bold ${e.cidre.coherenceCa>=95?"text-green-400":e.cidre.coherenceCa>=90?"text-yellow-400":"text-red-400"}`},e.cidre.coherenceCa.toFixed(1),"%"),React.createElement("td",{className:"text-right px-2"},"-"))))),React.createElement("p",{className:"text-xs text-neutral-500 mt-2"},"* CA th\xE9orique = (Pintes \xD7 ",u.prixPinte,"\u20AC) + (Pichets \xD7 ",u.prixPichet,"\u20AC) + (Gobelets \xD7 ",u.prixGobelet,"\u20AC)")),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-4"},"\u{1F37A} \xC9carts par bar"),React.createElement("div",{className:"space-y-2"},t.map(a=>React.createElement("div",{key:a.barId,className:`p-3 rounded-lg border ${a.statutPerte==="ok"?"bg-green-900/20 border-green-700":a.statutPerte==="attention"?"bg-yellow-900/20 border-yellow-700":"bg-red-900/20 border-red-700"}`},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",null,React.createElement("p",{className:"font-bold"},a.type==="biere"?"\u{1F37A}":"\u{1F34E}"," ",a.barNom),React.createElement("p",{className:"text-xs text-neutral-400"},a.futsVides," f\xFBts \u2022 ",a.volumeSorti,"L sorti \u2022 ",a.volumeVendu.toFixed(1),"L vendu")),React.createElement("div",{className:"text-right"},React.createElement("p",{className:`text-xl font-bold ${r(a.statutPerte)}`},a.tauxPerte.toFixed(1),"% ",n(a.statutPerte)),React.createElement("p",{className:"text-xs text-neutral-400"},a.caDeclare.toFixed(0),"\u20AC CA"))))))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-4"},"\u23F1\uFE0F CA par cr\xE9neau"),React.createElement("div",{className:"space-y-2"},s.map(a=>React.createElement("div",{key:a.creneauId,className:"p-3 bg-neutral-700/50 rounded-lg"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",null,React.createElement("p",{className:"font-bold"},a.creneauLabel),React.createElement("p",{className:"text-xs text-neutral-400"},a.pintes," pintes \u2022 ",a.pichets," pichets \u2022 ",a.gobelets," gobelets")),React.createElement("div",{className:"text-right"},React.createElement("p",{className:"text-lg font-bold text-emerald-400"},a.caDeclare.toFixed(0)," \u20AC"),React.createElement("p",{className:`text-xs ${a.ecartCa>=0?"text-green-400":"text-red-400"}`},"vs th\xE9o: ",a.ecartCa>=0?"+":"",a.ecartCa.toFixed(0),"\u20AC"))))))),React.createElement("div",{className:"bg-neutral-800 p-3 rounded-lg"},React.createElement("p",{className:"text-xs text-neutral-400"},React.createElement("span",{className:"text-green-400"},"\u2705 OK")," \u2264 ",u.seuilPerte,"% \u2022",React.createElement("span",{className:"text-yellow-400 ml-2"},"\u26A0\uFE0F Attention")," ",u.seuilPerte,"-",(u.seuilPerte*1.5).toFixed(0),"% \u2022",React.createElement("span",{className:"text-red-400 ml-2"},"\u{1F534} Alerte")," ",">"," ",(u.seuilPerte*1.5).toFixed(0),"%")))})(),ve==="graphiques"&&(()=>{const e=De(),t=wt(),s=je(),n=rs(),r=({type:a,data:o,options:d,id:b})=>{const l=is(null),g=is(null),[i,x]=m(!!window.Chart);return te(()=>{window.Chart||window.loadChartJS().then(()=>x(!0))},[]),te(()=>{if(!(!l.current||!i))return g.current&&g.current.destroy(),g.current=new Chart(l.current,{type:a,data:o,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#fff"}}},scales:a!=="pie"&&a!=="doughnut"?{x:{ticks:{color:"#aaa"},grid:{color:"#333"}},y:{ticks:{color:"#aaa"},grid:{color:"#333"}}}:void 0,...d}}),()=>{g.current&&g.current.destroy()}},[o,i]),React.createElement("canvas",{ref:l,id:b})};return React.createElement("div",{className:"space-y-4 max-w-2xl mx-auto"},React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F4C8} \xC9volution CA par cr\xE9neau (J",c,")"),React.createElement("div",{className:"h-64"},React.createElement(r,{id:"chartCaCreneaux",type:"line",data:{labels:t.map(a=>a.creneauLabel),datasets:[{label:"CA (\u20AC)",data:t.map(a=>a.caDeclare),borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.2)",fill:!0,tension:.3}]}}))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F3C6} CA par bar (J",c,")"),React.createElement("div",{className:"h-64"},React.createElement(r,{id:"chartCaBars",type:"bar",data:{labels:e.map(a=>a.barNom),datasets:[{label:"CA (\u20AC)",data:e.map(a=>a.caDeclare),backgroundColor:e.map(a=>a.type==="biere"?"#f59e0b":"#22c55e"),borderRadius:4}]}})),React.createElement("div",{className:"flex gap-4 mt-2 text-xs text-neutral-400 justify-center"},React.createElement("span",null,React.createElement("span",{className:"inline-block w-3 h-3 bg-amber-500 rounded mr-1"}),"Bi\xE8re"),React.createElement("span",null,React.createElement("span",{className:"inline-block w-3 h-3 bg-green-500 rounded mr-1"}),"Cidre"))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F967} R\xE9partition Bi\xE8re / Cidre (J",c,")"),React.createElement("div",{className:"h-64"},React.createElement(r,{id:"chartRepartition",type:"doughnut",data:{labels:["Bi\xE8re","Cidre"],datasets:[{data:[s.biere.caDeclare,s.cidre.caDeclare],backgroundColor:["#f59e0b","#22c55e"],borderColor:["#d97706","#16a34a"],borderWidth:2}]},options:{plugins:{legend:{position:"bottom",labels:{color:"#fff",padding:20}}}}})),React.createElement("div",{className:"grid grid-cols-2 gap-4 mt-4 text-center"},React.createElement("div",{className:"bg-amber-900/30 p-3 rounded-lg"},React.createElement("p",{className:"text-amber-400 font-bold text-xl"},s.biere.caDeclare.toFixed(0)," \u20AC"),React.createElement("p",{className:"text-xs text-neutral-400"},"Bi\xE8re (",s.total.caDeclare>0?(s.biere.caDeclare/s.total.caDeclare*100).toFixed(0):0,"%)")),React.createElement("div",{className:"bg-green-900/30 p-3 rounded-lg"},React.createElement("p",{className:"text-green-400 font-bold text-xl"},s.cidre.caDeclare.toFixed(0)," \u20AC"),React.createElement("p",{className:"text-xs text-neutral-400"},"Cidre (",s.total.caDeclare>0?(s.cidre.caDeclare/s.total.caDeclare*100).toFixed(0):0,"%)")))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F4C5} \xC9volution CA sur le festival"),React.createElement("div",{className:"h-64"},React.createElement(r,{id:"chartCaJours",type:"bar",data:{labels:n.jours.map(a=>`J${a.jour}`),datasets:[{label:"CA (\u20AC)",data:n.jours.map(a=>a.ca),backgroundColor:n.jours.map(a=>a.jour===c?"#f59e0b":"#6b7280"),borderRadius:4}]}}))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F4C9} Taux de perte par bar (J",c,")"),React.createElement("div",{className:"h-64"},React.createElement(r,{id:"chartPertesBars",type:"bar",data:{labels:e.map(a=>a.barNom),datasets:[{label:"Taux perte (%)",data:e.map(a=>a.tauxPerte),backgroundColor:e.map(a=>a.tauxPerte<=u.seuilPerte?"#22c55e":a.tauxPerte<=u.seuilPerte*1.5?"#eab308":"#ef4444"),borderRadius:4}]},options:{plugins:{annotation:{annotations:{line1:{type:"line",yMin:u.seuilPerte,yMax:u.seuilPerte,borderColor:"#ef4444",borderWidth:2,borderDash:[5,5]}}}}}})),React.createElement("p",{className:"text-xs text-neutral-500 mt-2 text-center"},"Seuil acceptable : ",u.seuilPerte,"% (ligne rouge pointill\xE9e)")))})(),ve==="comparatif"&&(()=>{const e=rs();return React.createElement("div",{className:"space-y-4 max-w-2xl mx-auto"},React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-4"},"\u{1F4C5} Comparatif Festival"),React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"w-full text-sm"},React.createElement("thead",null,React.createElement("tr",{className:"border-b border-neutral-600"},React.createElement("th",{className:"text-left py-2"}),e.jours.map(t=>React.createElement("th",{key:t.jour,className:`text-center py-2 px-2 ${t.jour===c?"text-amber-400":""}`},"J",t.jour)))),React.createElement("tbody",null,React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"\u{1F4B0} CA"),e.jours.map(t=>React.createElement("td",{key:t.jour,className:`text-center px-2 font-bold ${t.jour===c?"text-amber-400":""}`},t.hasDonnees?`${t.ca.toFixed(0)}\u20AC`:"-"))),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"\u{1F37A} F\xFBts bi\xE8re"),e.jours.map(t=>React.createElement("td",{key:t.jour,className:"text-center px-2"},t.hasDonnees?t.futsBiere:"-"))),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"\u{1F34E} F\xFBts cidre"),e.jours.map(t=>React.createElement("td",{key:t.jour,className:"text-center px-2"},t.hasDonnees?t.futsCidre:"-"))),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"\u{1F4C9} Taux perte"),e.jours.map(t=>React.createElement("td",{key:t.jour,className:`text-center px-2 ${t.tauxPerte<=u.seuilPerte?"text-green-400":t.tauxPerte<=u.seuilPerte*1.5?"text-yellow-400":"text-red-400"}`},t.hasDonnees?`${t.tauxPerte.toFixed(1)}%`:"-"))),React.createElement("tr",{className:"border-b border-neutral-700"},React.createElement("td",{className:"py-2 text-neutral-400"},"\u{1F3C6} Top bar"),e.jours.map(t=>React.createElement("td",{key:t.jour,className:"text-center px-2 text-xs"},t.hasDonnees?t.topBar:"-"))),React.createElement("tr",null,React.createElement("td",{className:"py-2 text-neutral-400"},"\u26A1 Pic"),e.jours.map(t=>React.createElement("td",{key:t.jour,className:"text-center px-2 text-xs"},t.hasDonnees?t.picCreneau:"-"))))))),React.createElement("div",{className:"grid grid-cols-2 gap-4"},React.createElement("div",{className:"bg-emerald-900/30 p-4 rounded-xl border border-emerald-700"},React.createElement("p",{className:"text-sm text-emerald-300"},"\u{1F4B0} CA Total Festival"),React.createElement("p",{className:"text-3xl font-black text-emerald-400"},e.caTotal.toFixed(0)," \u20AC")),React.createElement("div",{className:"bg-blue-900/30 p-4 rounded-xl border border-blue-700"},React.createElement("p",{className:"text-sm text-blue-300"},"\u{1F6E2}\uFE0F F\xFBts consomm\xE9s"),React.createElement("p",{className:"text-3xl font-black text-blue-400"},e.futsTotal))),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-4"},"\u{1F4C8} \xC9volution CA"),React.createElement("div",{className:"space-y-3"},e.jours.map((t,s)=>{const n=Math.max(...e.jours.map(o=>o.ca),1),r=t.ca/n*100,a=s>0&&e.jours[s-1].ca>0?((t.ca-e.jours[s-1].ca)/e.jours[s-1].ca*100).toFixed(0):null;return React.createElement("div",{key:t.jour},React.createElement("div",{className:"flex items-center justify-between mb-1"},React.createElement("span",{className:`font-bold ${t.jour===c?"text-amber-400":"text-neutral-300"}`},"Jour ",t.jour),React.createElement("div",null,React.createElement("span",{className:"font-bold"},t.ca.toFixed(0)," \u20AC"),a&&React.createElement("span",{className:`ml-2 text-sm ${parseInt(a)>=0?"text-green-400":"text-red-400"}`},"(",parseInt(a)>=0?"+":"",a,"%)"))),React.createElement("div",{className:"bg-neutral-700 rounded-full h-4 overflow-hidden"},React.createElement("div",{className:`h-full ${t.jour===c?"bg-amber-500":"bg-emerald-600"} transition-all`,style:{width:`${t.hasDonnees?r:0}%`}})))}))),c>1&&React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl"},React.createElement("h4",{className:"font-bold mb-3"},"\u{1F4CA} Moyennes"),React.createElement("div",{className:"grid grid-cols-2 gap-4 text-center"},React.createElement("div",null,React.createElement("p",{className:"text-neutral-400 text-sm"},"CA moyen/jour"),React.createElement("p",{className:"text-2xl font-bold text-emerald-400"},(e.caTotal/c).toFixed(0)," \u20AC")),React.createElement("div",null,React.createElement("p",{className:"text-neutral-400 text-sm"},"F\xFBts moy./jour"),React.createElement("p",{className:"text-2xl font-bold text-blue-400"},(e.futsTotal/c).toFixed(1))))))})())),ia&&React.createElement("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-sm p-6 text-center"},React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u{1F4F1} QR Code de la session"),React.createElement("p",{className:"text-neutral-400 text-sm mb-4"},"Scannez ce code pour rejoindre"),React.createElement("div",{className:"bg-white p-4 rounded-xl inline-block mb-4"},React.createElement("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(window.location.origin+window.location.pathname+"?session="+p)}`,alt:"QR Code",width:"200",height:"200"})),React.createElement("p",{className:"text-2xl font-mono font-bold text-red-400 mb-2"},p),React.createElement("p",{className:"text-xs text-neutral-500 mb-4 break-all"},window.location.origin+window.location.pathname,"?session=",p),React.createElement("button",{onClick:()=>hs(!1),className:"w-full py-3 bg-neutral-700 rounded-lg"},"Fermer"))),ea&&React.createElement("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-sm p-6"},React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u{1F4E1} Session"),React.createElement("div",{className:"bg-neutral-800 p-4 rounded-xl mb-4 text-center"},React.createElement("p",{className:"text-sm text-neutral-400"},"Code \xE0 partager"),React.createElement("p",{className:"text-2xl font-mono font-bold text-red-400"},p),React.createElement("button",{onClick:()=>{lt(!1),hs(!0)},className:"mt-2 px-4 py-2 bg-blue-600 rounded-lg text-sm"},"\u{1F4F1} Afficher QR Code")),React.createElement("div",null,React.createElement("div",{className:"flex items-center justify-between mb-2"},React.createElement("p",{className:"text-sm text-neutral-400"},"Utilisateurs connect\xE9s (",Be.length,")"),T?React.createElement("span",{className:"text-xs text-red-400 bg-red-900/50 px-2 py-0.5 rounded"},"\u{1F451} Super Admin"):D&&React.createElement("span",{className:"text-xs text-green-400 bg-green-900/50 px-2 py-0.5 rounded"},"\u{1F513} Admin")),React.createElement("div",{className:"space-y-1"},Be.map(e=>{var t,s;return React.createElement("div",{key:e,className:"flex items-center justify-between bg-neutral-800 px-3 py-2 rounded"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),React.createElement("span",null,e," ",e===A&&"(vous)"),(e===u.createdBy||((t=me[e])==null?void 0:t.isSuperAdmin))&&React.createElement("span",{className:"text-xs bg-red-800 px-1.5 py-0.5 rounded"},"\u{1F451} Super Admin")),T&&e!==A&&e!==u.createdBy&&!((s=me[e])!=null&&s.isSuperAdmin)&&React.createElement("button",{onClick:()=>va(e),className:"px-2 py-1 bg-red-600/50 hover:bg-red-600 rounded text-xs font-medium transition-colors"},"\u274C \xC9jecter"))}))),React.createElement("div",{className:"flex gap-2 mt-4"},React.createElement("button",{onClick:()=>{lt(!1),mt(!0),pt(0)},className:"py-3 px-4 bg-blue-900 hover:bg-blue-800 rounded-lg text-sm"},"\u{1F4D6} Tutoriel"),React.createElement("button",{onClick:()=>lt(!1),className:"flex-1 py-3 bg-neutral-700 rounded-lg"},"Fermer"),React.createElement("button",{onClick:Ca,className:"flex-1 py-3 bg-red-900 hover:bg-red-800 rounded-lg text-red-300 border border-red-700"},"\u{1F6AA} D\xE9connexion")))),Ys&&React.createElement("div",{className:"fixed inset-0 bg-black/90 flex flex-col z-50"},React.createElement("div",{className:"bg-indigo-900 px-4 py-3 flex items-center justify-between"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"text-xl"},"\u{1F465}"),React.createElement("h3",{className:"font-bold"},"Gestion B\xE9n\xE9voles"),React.createElement("span",{className:"ml-2 px-2 py-1 bg-indigo-700 rounded text-sm font-bold"},"J",c)),React.createElement("button",{onClick:()=>ds(!1),className:"text-2xl"},"\u2715")),React.createElement("div",{className:"flex border-b border-neutral-700"},React.createElement("button",{onClick:()=>Re("planning"),className:`flex-1 py-3 text-sm font-medium ${Ee==="planning"?"bg-indigo-600 text-white":"bg-neutral-800 text-neutral-400"}`},"\u{1F4C5} Planning"),React.createElement("button",{onClick:()=>Re("synthese"),className:`flex-1 py-3 text-sm font-medium ${Ee==="synthese"?"bg-indigo-600 text-white":"bg-neutral-800 text-neutral-400"}`},"\u{1F4CA} Synth\xE8se"),T?React.createElement("button",{onClick:_a,className:`flex-1 py-3 text-sm font-medium ${Ee==="parametres"?"bg-indigo-600 text-white":"bg-neutral-800 text-neutral-400"}`},"\u23F0 Cr\xE9neaux"):React.createElement("button",{disabled:!0,className:"flex-1 py-3 text-sm font-medium bg-neutral-900 text-neutral-600 cursor-not-allowed",title:"R\xE9serv\xE9 au cr\xE9ateur de la session"},"\u{1F512} Cr\xE9neaux")),React.createElement("div",{className:"flex-1 overflow-y-auto p-4"},Ee==="planning"&&React.createElement("div",null,w.length===0?React.createElement("div",{className:"text-center py-8 text-neutral-500"},React.createElement("p",null,"Aucun bar configur\xE9"),React.createElement("p",{className:"text-sm"},"Ajoutez des bars dans les param\xE8tres")):React.createElement(React.Fragment,null,c>1&&ue===0&&React.createElement("div",{className:"mb-4 p-3 bg-amber-900/30 border border-amber-700 rounded-xl text-center"},React.createElement("p",{className:"text-sm text-amber-300 mb-2"},"Aucune affectation pour J",c),React.createElement("button",{onClick:Ma,disabled:Y,className:"px-4 py-2 bg-amber-600 hover:bg-amber-500 rounded-lg text-sm font-medium disabled:opacity-50"},"\u{1F4CB} Copier depuis J",c-1)),React.createElement("div",{className:"flex items-center justify-center gap-4 mb-6"},React.createElement("button",{onClick:()=>{const e=w.findIndex(t=>t.id===U);e>0&&Me(w[e-1].id)},disabled:w.findIndex(e=>e.id===U)===0,className:"w-10 h-10 bg-neutral-700 rounded-full disabled:opacity-30"},"\u25C0"),React.createElement("div",{className:"text-center"},React.createElement("h4",{className:"text-lg font-bold"},((Us=w.find(e=>e.id===U))==null?void 0:Us.nom)||"Bar"),React.createElement("p",{className:"text-sm text-neutral-400"},((zs=w.find(e=>e.id===U))==null?void 0:zs.type)==="biere"?"\u{1F37A} Bi\xE8re":"\u{1F34E} Cidre")),React.createElement("button",{onClick:()=>{const e=w.findIndex(t=>t.id===U);e<w.length-1&&Me(w[e+1].id)},disabled:w.findIndex(e=>e.id===U)===w.length-1,className:"w-10 h-10 bg-neutral-700 rounded-full disabled:opacity-30"},"\u25B6")),React.createElement("div",{className:"flex justify-center gap-2 mb-6"},w.map(e=>{const t=K[e.id]&&Object.keys(K[e.id]).length>0;return React.createElement("button",{key:e.id,onClick:()=>Me(e.id),className:`w-10 h-10 rounded-full font-bold text-sm ${U===e.id?"bg-indigo-600 text-white scale-110":t?"bg-green-600 text-white":"bg-neutral-700 text-neutral-400"}`},w.indexOf(e)+1)})),React.createElement("div",{className:"space-y-3"},O.map(e=>{var n,r,a;const t=U?Nt(U,e.id):null,s=t&&(((n=t.vendeur)==null?void 0:n.nom)||((r=t.serveur)==null?void 0:r.nom)||((a=t.runner)==null?void 0:a.nom));return React.createElement("div",{key:e.id,className:`rounded-xl p-4 ${s?"bg-green-900/30 border border-green-700":"bg-neutral-800"}`},React.createElement("div",{className:"flex items-center justify-between mb-3"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"text-lg"},"\u23F0"),React.createElement("span",{className:"font-bold"},e.label)),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>Ba(U,e.id),className:"px-3 py-1.5 bg-indigo-600 rounded-lg text-sm"},s?"\u270F\uFE0F Modifier":"\u2795 Affecter"),s&&React.createElement("button",{onClick:()=>Oa(U,e.id),className:"px-3 py-1.5 bg-red-600/50 rounded-lg text-sm"},"\u{1F5D1}\uFE0F"))),s?React.createElement("div",{className:"grid grid-cols-3 gap-2"},React.createElement("div",{className:"bg-amber-900/30 p-2 rounded-lg"},React.createElement("p",{className:"text-xs text-amber-400 mb-1"},"\u{1F6D2} Vendeur"),React.createElement("p",{className:"text-sm font-medium"},ce(t.vendeur))),React.createElement("div",{className:"bg-blue-900/30 p-2 rounded-lg"},React.createElement("p",{className:"text-xs text-blue-400 mb-1"},"\u{1F37A} Serveur"),React.createElement("p",{className:"text-sm font-medium"},ce(t.serveur))),React.createElement("div",{className:"bg-purple-900/30 p-2 rounded-lg"},React.createElement("p",{className:"text-xs text-purple-400 mb-1"},"\u{1F3C3} Runner"),React.createElement("p",{className:"text-sm font-medium"},ce(t.runner)))):React.createElement("p",{className:"text-neutral-500 text-sm text-center py-2"},"Aucun b\xE9n\xE9vole affect\xE9"))})))),Ee==="synthese"&&React.createElement("div",null,React.createElement("div",{className:"flex items-center justify-between mb-4"},React.createElement("h4",{className:"font-bold"},"Tableau de synth\xE8se"),React.createElement("button",{onClick:ts,disabled:ue===0,className:"px-4 py-2 bg-green-600 rounded-lg text-sm disabled:opacity-50"},"\u{1F4E5} Exporter CSV")),React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"w-full text-sm border-collapse"},React.createElement("thead",null,React.createElement("tr",{className:"bg-indigo-900"},React.createElement("th",{className:"border border-indigo-700 px-2 py-2 text-left"},"Bar"),React.createElement("th",{className:"border border-indigo-700 px-2 py-2 text-left"},"Cr\xE9neau"),React.createElement("th",{className:"border border-indigo-700 px-2 py-2 text-amber-400"},"\u{1F6D2}"),React.createElement("th",{className:"border border-indigo-700 px-2 py-2 text-blue-400"},"\u{1F37A}"),React.createElement("th",{className:"border border-indigo-700 px-2 py-2 text-purple-400"},"\u{1F3C3}"))),React.createElement("tbody",null,w.map((e,t)=>O.map((s,n)=>{const r=Nt(e.id,s.id);return React.createElement("tr",{key:`${e.id}-${s.id}`,className:n%2===0?"bg-neutral-900":"bg-neutral-800"},n===0&&React.createElement("td",{rowSpan:O.length,className:`border border-neutral-700 px-2 py-1 font-medium ${e.type==="biere"?"bg-emerald-900/30":"bg-teal-900/30"}`},e.nom),React.createElement("td",{className:"border border-neutral-700 px-2 py-1 text-neutral-400"},s.label),React.createElement("td",{className:"border border-neutral-700 px-2 py-1 text-xs"},r?ce(r.vendeur):"-"),React.createElement("td",{className:"border border-neutral-700 px-2 py-1 text-xs"},r?ce(r.serveur):"-"),React.createElement("td",{className:"border border-neutral-700 px-2 py-1 text-xs"},r?ce(r.runner):"-"))}))))),React.createElement("div",{className:"mt-4 p-3 bg-indigo-900/30 rounded-xl"},React.createElement("p",{className:"text-sm"},React.createElement("strong",null,"R\xE9sum\xE9 :")," ",ue," cr\xE9neau(x) avec affectation(s) sur ",w.length*O.length," possibles"))),Ee==="parametres"&&React.createElement("div",null,React.createElement("h4",{className:"font-bold mb-4"},"Configuration des cr\xE9neaux horaires"),React.createElement("div",{className:"space-y-2 mb-6"},fe.map((e,t)=>React.createElement("div",{key:e.id,className:"flex items-center gap-2 bg-neutral-800 p-3 rounded-lg"},React.createElement("span",{className:"w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center text-sm font-bold"},t+1),React.createElement("input",{type:"text",value:e.label,onChange:s=>{const n=[...fe];n[t]={...e,label:s.target.value},ot(n)},className:"flex-1 px-3 py-2 bg-neutral-700 rounded-lg"}),React.createElement("button",{onClick:()=>qa(e.id),disabled:fe.length<=1,className:"p-2 text-red-400 disabled:opacity-30"},"\u{1F5D1}\uFE0F")))),fe.length<10&&React.createElement("div",{className:"flex gap-2 mb-6"},React.createElement("input",{type:"text",value:it,onChange:e=>kt(e.target.value),placeholder:"Nouveau cr\xE9neau (ex: 14h-16h)",className:"flex-1 px-4 py-2 bg-neutral-800 rounded-lg",onKeyDown:e=>e.key==="Enter"&&Ls()}),React.createElement("button",{onClick:Ls,disabled:!it.trim(),className:"px-4 py-2 bg-indigo-600 rounded-lg disabled:opacity-50"},"\u2795")),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>Re("planning"),className:"flex-1 py-3 bg-neutral-700 rounded-lg"},"Annuler"),React.createElement("button",{onClick:Ja,className:"flex-1 py-3 bg-indigo-600 rounded-lg font-medium"},"\u{1F4BE} Sauvegarder"))))),Zs&&Q&&React.createElement("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-[60]"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-md p-6 max-h-[90vh] overflow-y-auto"},React.createElement("h3",{className:"text-xl font-bold mb-2"},"\u{1F465} Affecter les b\xE9n\xE9voles"),React.createElement("p",{className:"text-neutral-400 text-sm mb-4"},(Hs=w.find(e=>e.id===Q.barId))==null?void 0:Hs.nom," - ",(Gs=O.find(e=>e.id===Q.creneauId))==null?void 0:Gs.label),React.createElement("div",{className:"space-y-4"},React.createElement("div",{className:"bg-amber-900/20 p-4 rounded-xl border border-amber-700"},React.createElement("label",{className:"block text-sm font-bold text-amber-400 mb-2"},"\u{1F6D2} Vendeur"),React.createElement("div",{className:"grid grid-cols-2 gap-2"},React.createElement("input",{type:"text",placeholder:"Pr\xE9nom",value:Q.vendeur.prenom,onChange:e=>le(t=>({...t,vendeur:{...t.vendeur,prenom:e.target.value}})),className:"px-3 py-2 bg-neutral-800 rounded-lg"}),React.createElement("input",{type:"text",placeholder:"Nom",value:Q.vendeur.nom,onChange:e=>le(t=>({...t,vendeur:{...t.vendeur,nom:e.target.value}})),className:"px-3 py-2 bg-neutral-800 rounded-lg"}))),React.createElement("div",{className:"bg-blue-900/20 p-4 rounded-xl border border-blue-700"},React.createElement("label",{className:"block text-sm font-bold text-blue-400 mb-2"},"\u{1F37A} Serveur"),React.createElement("div",{className:"grid grid-cols-2 gap-2"},React.createElement("input",{type:"text",placeholder:"Pr\xE9nom",value:Q.serveur.prenom,onChange:e=>le(t=>({...t,serveur:{...t.serveur,prenom:e.target.value}})),className:"px-3 py-2 bg-neutral-800 rounded-lg"}),React.createElement("input",{type:"text",placeholder:"Nom",value:Q.serveur.nom,onChange:e=>le(t=>({...t,serveur:{...t.serveur,nom:e.target.value}})),className:"px-3 py-2 bg-neutral-800 rounded-lg"}))),React.createElement("div",{className:"bg-purple-900/20 p-4 rounded-xl border border-purple-700"},React.createElement("label",{className:"block text-sm font-bold text-purple-400 mb-2"},"\u{1F3C3} Runner"),React.createElement("div",{className:"grid grid-cols-2 gap-2"},React.createElement("input",{type:"text",placeholder:"Pr\xE9nom",value:Q.runner.prenom,onChange:e=>le(t=>({...t,runner:{...t.runner,prenom:e.target.value}})),className:"px-3 py-2 bg-neutral-800 rounded-lg"}),React.createElement("input",{type:"text",placeholder:"Nom",value:Q.runner.nom,onChange:e=>le(t=>({...t,runner:{...t.runner,nom:e.target.value}})),className:"px-3 py-2 bg-neutral-800 rounded-lg"})))),React.createElement("div",{className:"flex gap-2 mt-6"},React.createElement("button",{onClick:()=>{At(!1),le(null)},className:"flex-1 py-3 bg-neutral-700 rounded-lg"},"Annuler"),React.createElement("button",{onClick:La,className:"flex-1 py-3 bg-indigo-600 rounded-lg font-medium"},"\u2713 Enregistrer")))),ca&&React.createElement("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[60]"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-md overflow-hidden"},ae===0&&React.createElement("div",{className:"p-6 text-center"},React.createElement("img",{src:"logo-hellfest.png",alt:"Hellfest",className:"w-20 h-20 mx-auto mb-4"}),React.createElement("h2",{className:"text-2xl font-bold text-green-400 mb-2"},"Bienvenue !"),React.createElement("p",{className:"text-neutral-300 mb-4"},"Application de gestion des f\xFBts pour les Bars Nomades du Hellfest 2026"),React.createElement("p",{className:"text-sm text-neutral-400"},"Suivez ce petit guide pour d\xE9couvrir les fonctionnalit\xE9s principales.")),ae===1&&React.createElement("div",{className:"p-6"},React.createElement("div",{className:"text-4xl mb-4 text-center"},"\u2795"),React.createElement("h3",{className:"text-xl font-bold mb-3 text-center"},"Attribuer un f\xFBt"),React.createElement("div",{className:"bg-amber-900/30 p-4 rounded-xl mb-4"},React.createElement("p",{className:"text-sm text-neutral-300 mb-2"},"Utilisez le bouton ",React.createElement("span",{className:"bg-amber-600 px-2 py-1 rounded text-xs font-bold"},"\u2795 F\xFBt")," en bas de l'\xE9cran"),React.createElement("p",{className:"text-xs text-neutral-400"},"S\xE9lectionnez le bar qui re\xE7oit le f\xFBt (\u{1F37A} bi\xE8re ou \u{1F34E} cidre).")),React.createElement("div",{className:"bg-neutral-800 p-3 rounded-lg"},React.createElement("p",{className:"text-xs text-neutral-400"},"\u{1F4A1} Les couleurs indiquent la dur\xE9e :"),React.createElement("div",{className:"flex gap-2 mt-2 text-xs"},React.createElement("span",{className:"bg-neutral-700 px-2 py-1 rounded"},"<1h30"),React.createElement("span",{className:"bg-yellow-500 text-black px-2 py-1 rounded"},"1h30-3h"),React.createElement("span",{className:"bg-orange-500 px-2 py-1 rounded"},"3h-4h"),React.createElement("span",{className:"bg-red-600 px-2 py-1 rounded"},">4h")))),ae===2&&React.createElement("div",{className:"p-6"},React.createElement("div",{className:"text-4xl mb-4 text-center"},"\u21A9\uFE0F"),React.createElement("h3",{className:"text-xl font-bold mb-3 text-center"},"Retourner un f\xFBt"),React.createElement("div",{className:"bg-blue-900/30 p-4 rounded-xl mb-4"},React.createElement("p",{className:"text-sm text-neutral-300 mb-2"},"Cliquez sur ",React.createElement("span",{className:"bg-black/30 px-2 py-1 rounded text-xs"},"\u21A9\uFE0F Retour")," \xE0 c\xF4t\xE9 du f\xFBt")),React.createElement("div",{className:"space-y-2 text-sm"},React.createElement("div",{className:"flex items-center gap-2 bg-neutral-800 p-2 rounded"},React.createElement("span",null,"\u{1F4E6}"),React.createElement("span",{className:"text-neutral-300"},"F\xFBt vide"),React.createElement("span",{className:"text-xs text-neutral-500 ml-auto"},"Le plus courant")),React.createElement("div",{className:"flex items-center gap-2 bg-neutral-800 p-2 rounded"},React.createElement("span",null,"\u{1F4A5}"),React.createElement("span",{className:"text-neutral-300"},"F\xFBt cass\xE9"),React.createElement("span",{className:"text-xs text-neutral-500 ml-auto"},"Probl\xE8me technique")),React.createElement("div",{className:"flex items-center gap-2 bg-neutral-800 p-2 rounded"},React.createElement("span",null,"\u267B\uFE0F"),React.createElement("span",{className:"text-neutral-300"},"Non termin\xE9"),React.createElement("span",{className:"text-xs text-neutral-500 ml-auto"},"Reprendre demain")),React.createElement("div",{className:"flex items-center gap-2 bg-green-900/30 p-2 rounded border border-green-600"},React.createElement("span",null,"\u{1F504}"),React.createElement("span",{className:"text-green-300"},"F\xFBt plein"),React.createElement("span",{className:"text-xs text-green-500 ml-auto"},"R\xE9int\xE8gre le stock")))),ae===3&&React.createElement("div",{className:"p-6"},React.createElement("div",{className:"text-4xl mb-4 text-center"},"\u{1F4B0}"),React.createElement("h3",{className:"text-xl font-bold mb-3 text-center"},"Enregistrer les ventes"),React.createElement("div",{className:"bg-emerald-900/30 p-4 rounded-xl mb-4"},React.createElement("p",{className:"text-sm text-neutral-300 mb-2"},"Utilisez le bouton ",React.createElement("span",{className:"bg-emerald-600 px-2 py-1 rounded text-xs font-bold"},"\u{1F4B0} Vente")," en bas de l'\xE9cran")),React.createElement("div",{className:"bg-neutral-800 p-3 rounded-lg text-sm mb-3"},React.createElement("p",{className:"text-neutral-300 mb-2"},"Renseignez par cr\xE9neau :"),React.createElement("ul",{className:"text-neutral-400 text-xs space-y-1 ml-4"},React.createElement("li",null,"\u2022 Le montant total en \u20AC"),React.createElement("li",null,"\u2022 Nombre de pintes, pichets, gobelets"))),React.createElement("div",{className:"bg-orange-900/30 p-3 rounded-lg text-xs border border-orange-600/50"},React.createElement("p",{className:"text-orange-300 font-bold mb-1"},"\u26A0\uFE0F PAD d\xE9faillant ?"),React.createElement("p",{className:"text-orange-200"},"Cochez la case : le cr\xE9neau restera ouvert pour ajouter les donn\xE9es du PAD de remplacement."))),ae===4&&React.createElement("div",{className:"p-6"},React.createElement("div",{className:"text-4xl mb-4 text-center"},"\u{1F5FA}\uFE0F"),React.createElement("h3",{className:"text-xl font-bold mb-3 text-center"},"Vue Plan du Festival"),React.createElement("div",{className:"bg-purple-900/30 p-4 rounded-xl mb-4"},React.createElement("p",{className:"text-sm text-neutral-300 mb-2"},"Utilisez le bouton ",React.createElement("span",{className:"bg-purple-600 px-2 py-1 rounded text-xs font-bold"},"\u{1F5FA}\uFE0F Plan")," en bas de l'\xE9cran")),React.createElement("div",{className:"bg-neutral-800 p-3 rounded-lg text-sm"},React.createElement("p",{className:"text-neutral-300 mb-2"},"Visualisez en temps r\xE9el :"),React.createElement("ul",{className:"text-neutral-400 text-xs space-y-1 ml-4"},React.createElement("li",null,"\u2022 Position des bars sur le plan"),React.createElement("li",null,"\u2022 \u{1F7E2} Vert = f\xFBts disponibles"),React.createElement("li",null,"\u2022 \u{1F7E1} Jaune = en service"),React.createElement("li",null,"\u2022 \u{1F534} Rouge = complet")),React.createElement("p",{className:"text-neutral-500 text-xs mt-2"},"\u{1F4A1} Super Admin peut positionner les bars"))),ae===5&&React.createElement("div",{className:"p-6"},React.createElement("div",{className:"text-4xl mb-4 text-center"},"\u{1F510}"),React.createElement("h3",{className:"text-xl font-bold mb-3 text-center"},"Niveaux d'acc\xE8s"),React.createElement("div",{className:"space-y-3 text-sm"},React.createElement("div",{className:"bg-neutral-800 p-3 rounded-lg"},React.createElement("p",{className:"text-neutral-300 font-bold"},"\u{1F464} B\xE9n\xE9vole"),React.createElement("p",{className:"text-neutral-500 text-xs"},"Voir les f\xFBts, consulter le plan")),React.createElement("div",{className:"bg-red-900/30 p-3 rounded-lg border border-red-600/30"},React.createElement("p",{className:"text-red-300 font-bold"},"\u{1F510} Admin"),React.createElement("p",{className:"text-neutral-400 text-xs"},"+ Attribuer/retourner f\xFBts, saisir ventes, g\xE9rer b\xE9n\xE9voles, exports")),React.createElement("div",{className:"bg-amber-900/30 p-3 rounded-lg border border-amber-600/30"},React.createElement("p",{className:"text-amber-300 font-bold"},"\u{1F451} Super Admin"),React.createElement("p",{className:"text-neutral-400 text-xs"},"+ Cr\xE9er sessions, configurer bars, positionner sur le plan, RGPD")))),ae===6&&React.createElement("div",{className:"p-6 text-center"},React.createElement("div",{className:"text-6xl mb-4"},"\u{1F389}"),React.createElement("h3",{className:"text-xl font-bold mb-3"},"C'est parti !"),React.createElement("p",{className:"text-neutral-300 mb-4"},"Vous \xEAtes pr\xEAt \xE0 utiliser l'application."),React.createElement("div",{className:"bg-neutral-800 p-3 rounded-lg text-sm text-left"},React.createElement("p",{className:"text-neutral-400 mb-2"},"\u{1F4A1} Astuces :"),React.createElement("ul",{className:"text-xs text-neutral-500 space-y-1"},React.createElement("li",null,"\u2022 Cliquez sur le code session pour voir les infos"),React.createElement("li",null,"\u2022 Installez l'app (PWA) pour un acc\xE8s rapide"),React.createElement("li",null,"\u2022 Le tutoriel est accessible dans les infos session")))),React.createElement("div",{className:"bg-neutral-800 px-6 py-4 flex items-center justify-between"},React.createElement("div",{className:"flex gap-1"},[0,1,2,3,4,5,6].map(e=>React.createElement("div",{key:e,className:`w-2 h-2 rounded-full ${ae===e?"bg-red-500":"bg-neutral-600"}`}))),React.createElement("div",{className:"flex gap-2"},ae>0&&React.createElement("button",{onClick:()=>pt(e=>e-1),className:"px-4 py-2 bg-neutral-700 rounded-lg text-sm"},"\u2190 Pr\xE9c\xE9dent"),ae<6?React.createElement("button",{onClick:()=>pt(e=>e+1),className:"px-4 py-2 bg-red-600 rounded-lg text-sm font-medium"},"Suivant \u2192"):React.createElement("button",{onClick:()=>{mt(!1),localStorage.setItem("gestionFuts_tutorielVu","true")},className:"px-4 py-2 bg-green-600 rounded-lg text-sm font-medium"},"\u2713 Commencer"))),React.createElement("button",{onClick:()=>{mt(!1),localStorage.setItem("gestionFuts_tutorielVu","true")},className:"w-full py-2 text-neutral-500 text-sm hover:text-neutral-300"},"Passer le tutoriel"))),React.createElement("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-40"},React.createElement("div",{className:"flex gap-2 bg-neutral-900/95 backdrop-blur px-4 py-3 rounded-2xl shadow-lg border border-neutral-700"},React.createElement("button",{onClick:()=>Qt(!0),disabled:Y,className:"px-4 py-3 bg-amber-600 hover:bg-amber-500 rounded-xl font-medium text-sm flex items-center gap-2 disabled:opacity-50"},"\u2795 F\xFBt"),React.createElement("button",{onClick:()=>rt(!0),className:"px-4 py-3 bg-emerald-600 hover:bg-emerald-500 rounded-xl font-medium text-sm flex items-center gap-2"},"\u{1F4B0} Vente"),React.createElement("button",{onClick:()=>ks(!0),className:"px-4 py-3 bg-blue-600 hover:bg-blue-500 rounded-xl font-medium text-sm flex items-center gap-2"},"\u{1F5FA}\uFE0F Plan"))),ma&&React.createElement("div",{className:"fixed inset-0 bg-black/95 flex flex-col z-50"},React.createElement("div",{className:"bg-blue-900 px-4 py-2 flex items-center justify-between shrink-0"},React.createElement("h3",{className:"text-lg font-bold"},"\u{1F5FA}\uFE0F Plan du Festival"),React.createElement("div",{className:"flex items-center gap-2"},T&&React.createElement("button",{onClick:()=>{if(Wt(!H),ft(null),!H){const e=w.find(t=>!xt[t.id]);bt(e?e.id:null)}},className:`px-2 py-1 rounded-lg text-xs ${H?"bg-orange-600":"bg-neutral-700"}`},H?"\u270F\uFE0F Placement ON":"\u2699\uFE0F Config"),React.createElement("button",{onClick:()=>{ks(!1),Wt(!1),ft(null)},className:"text-2xl"},"\u2715"))),H&&React.createElement("div",{className:"bg-orange-900/50 px-3 py-2 border-b border-orange-700 shrink-0"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{className:"text-xs"},Te?React.createElement("p",null,"\u{1F446} Cliquez pour placer : ",React.createElement("span",{className:"font-bold text-orange-300"},(Xs=w.find(e=>e.id===Te))==null?void 0:Xs.nom)):React.createElement("p",{className:"text-green-400"},"\u2705 Tous positionn\xE9s !")),React.createElement("button",{onClick:Ta,className:"text-xs px-2 py-1 bg-red-600/50 rounded"},"\u{1F504} Reset")),React.createElement("div",{className:"flex flex-wrap gap-1 mt-2"},w.map(e=>{const t=!!xt[e.id],s=Te===e.id;return React.createElement("button",{key:e.id,onClick:()=>bt(e.id),className:`px-2 py-0.5 rounded text-xs ${s?"bg-orange-500 ring-2 ring-white":t?"bg-green-700":"bg-neutral-700"}`},e.type==="biere"?"\u{1F37A}":"\u{1F34E}"," ",e.nom," ",t&&"\u2713")}))),React.createElement("div",{className:"flex-1 overflow-auto p-2"},React.createElement("div",{className:"relative mx-auto bg-neutral-800 rounded-lg overflow-hidden",style:{aspectRatio:"1387 / 667",width:"100%",maxWidth:"1387px",minWidth:"600px"},onClick:e=>{(e.target===e.currentTarget||e.target.tagName==="IMG")&&(H||ft(null)),Ra(e)}},React.createElement("img",{src:"plan-hellfest.jpg",alt:"Plan Hellfest",className:`absolute inset-0 w-full h-full object-cover ${H?"cursor-crosshair":""}`,draggable:!1}),w.map(e=>{const t=xt[e.id];if(!t)return null;const s=e.futs||[],n=s.length>=u.maxFutsParBar,r=s.length===0,a=n?"bg-red-500":r?"bg-green-500":"bg-yellow-500",o=n?"border-t-red-500":r?"border-t-green-500":"border-t-yellow-500",d=e.type==="biere",b=pa===e.id;return React.createElement("div",{key:e.id,className:"absolute transform -translate-x-1/2 -translate-y-full",style:{left:`${t.x}%`,top:`${t.y}%`,zIndex:b?50:10}},React.createElement("div",{className:`relative cursor-pointer transition-transform ${b?"scale-125":"hover:scale-110"} ${H?"animate-bounce":""}`,onClick:l=>{l.stopPropagation(),H||ft(b?null:e.id)}},React.createElement("div",{className:`w-7 h-7 sm:w-9 sm:h-9 ${a} rounded-full border-2 sm:border-3 border-white shadow-lg flex items-center justify-center text-sm sm:text-base`},d?"\u{1F37A}":"\u{1F34E}"),React.createElement("div",{className:"absolute -top-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 bg-black border border-white sm:border-2 rounded-full flex items-center justify-center text-[10px] sm:text-xs font-bold"},s.length),React.createElement("div",{className:`absolute left-1/2 -bottom-1.5 sm:-bottom-2 transform -translate-x-1/2 w-0 h-0 border-l-[5px] sm:border-l-[7px] border-r-[5px] sm:border-r-[7px] border-t-[8px] sm:border-t-[10px] border-l-transparent border-r-transparent ${o}`})),b&&!H&&React.createElement("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-20"},React.createElement("div",{className:"bg-neutral-900 rounded-lg p-3 min-w-[140px] shadow-xl border border-neutral-500"},React.createElement("p",{className:"font-bold text-sm mb-1"},d?"\u{1F37A}":"\u{1F34E}"," ",e.nom),React.createElement("div",{className:"flex items-center gap-1 mb-2"},Array.from({length:u.maxFutsParBar}).map((l,g)=>React.createElement("span",{key:g,className:`text-xs ${g<s.length?"":"opacity-30"}`},"\u{1F6E2}\uFE0F")),React.createElement("span",{className:`text-xs font-bold ml-1 ${n?"text-red-400":r?"text-green-400":"text-yellow-400"}`},s.length,"/",u.maxFutsParBar)),s.length>0&&React.createElement("div",{className:"text-xs text-neutral-400 space-y-0.5"},s.map((l,g)=>{const i=l.dateAttribution?Rs(l.dateAttribution):"",x=l.dateAttribution?ba(l.dateAttribution):"";return React.createElement("div",{key:g,className:`px-1 rounded ${i}`},"F\xFBt ",g+1," ",x&&`\u2022 ${x}`)})),React.createElement("p",{className:`text-xs mt-2 font-medium ${n?"text-red-400":r?"text-green-400":"text-yellow-400"}`},n?"\u{1F534} COMPLET":r?"\u{1F7E2} DISPO":"\u{1F7E1} EN SERVICE")),React.createElement("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-[8px] border-r-[8px] border-t-[8px] border-l-transparent border-r-transparent border-t-neutral-900"})),H&&React.createElement("button",{onClick:l=>{l.stopPropagation(),Ia(e.id)},className:"absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs bg-red-600 hover:bg-red-500 rounded px-1"},"\u2715"))}))),React.createElement("div",{className:"bg-neutral-800 px-4 py-2 flex items-center justify-between text-xs shrink-0"},React.createElement("div",{className:"flex items-center gap-4"},React.createElement("span",{className:"flex items-center gap-1"},React.createElement("span",{className:"w-2.5 h-2.5 bg-green-500 rounded-full"})," Dispo"),React.createElement("span",{className:"flex items-center gap-1"},React.createElement("span",{className:"w-2.5 h-2.5 bg-yellow-500 rounded-full"})," En service"),React.createElement("span",{className:"flex items-center gap-1"},React.createElement("span",{className:"w-2.5 h-2.5 bg-red-500 rounded-full"})," Complet")),React.createElement("span",{className:"text-neutral-500"},"\u2194\uFE0F Scroll horizontal"))),ua&&React.createElement("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50"},React.createElement("div",{className:"bg-neutral-900 rounded-2xl w-full max-w-md p-6"},_?React.createElement(React.Fragment,null,React.createElement("div",{className:"text-center"},React.createElement("div",{className:"text-5xl mb-4"},_.barType==="biere"?"\u{1F37A}":"\u{1F34E}"),React.createElement("h3",{className:"text-xl font-bold mb-2"},"Confirmer l'attribution"),React.createElement("p",{className:"text-2xl font-black text-white mb-4"},_.barNom)),React.createElement("div",{className:"bg-neutral-800 rounded-xl p-4 mb-4"},React.createElement("div",{className:"flex items-center justify-between mb-3"},React.createElement("span",{className:"text-neutral-400"},"Actuellement :"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("div",{className:"flex gap-1"},Array.from({length:_.maxFuts}).map((e,t)=>React.createElement("span",{key:t,className:`text-xl ${t<_.currentFuts?"":"opacity-30"}`},"\u{1F6E2}\uFE0F"))),React.createElement("span",{className:`text-2xl font-black ${_.currentFuts>0?"text-yellow-400":"text-green-400"}`},_.currentFuts))),React.createElement("div",{className:"flex items-center justify-center text-3xl text-green-400 my-2"},"\u2193 +1"),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-neutral-400"},"Apr\xE8s :"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("div",{className:"flex gap-1"},Array.from({length:_.maxFuts}).map((e,t)=>React.createElement("span",{key:t,className:`text-xl ${t<_.currentFuts+1?"":"opacity-30"}`},"\u{1F6E2}\uFE0F"))),React.createElement("span",{className:`text-2xl font-black ${_.currentFuts+1>=_.maxFuts?"text-red-400":"text-yellow-400"}`},_.currentFuts+1))),_.currentFuts+1>=_.maxFuts&&React.createElement("div",{className:"mt-3 text-center"},React.createElement("span",{className:"text-red-400 text-sm font-bold bg-red-900/50 px-3 py-1 rounded-full"},"\u26A0\uFE0F Ce bar sera COMPLET"))),React.createElement("div",{className:"flex gap-3"},React.createElement("button",{onClick:()=>ct(null),className:"flex-1 py-4 bg-neutral-700 hover:bg-neutral-600 rounded-xl font-medium text-lg"},"\u2190 Retour"),React.createElement("button",{onClick:()=>{Sa(_.barId),ct(null),Qt(!1)},disabled:Y,className:"flex-1 py-4 bg-green-600 hover:bg-green-500 rounded-xl font-bold text-lg disabled:opacity-50"},Y?"\u23F3":"\u2713 CONFIRMER"))):React.createElement(React.Fragment,null,React.createElement("h3",{className:"text-xl font-bold mb-4"},"\u2795 Attribuer un f\xFBt"),React.createElement("p",{className:"text-neutral-400 text-sm mb-4"},"S\xE9lectionnez le bar :"),React.createElement("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto"},w.map(e=>{const t=e.type==="biere",s=e.futs||[],n=s.length<u.maxFutsParBar&&(t?ie>0:de>0),r=s.length>=u.maxFutsParBar;return React.createElement("button",{key:e.id,onClick:()=>ct({barId:e.id,barNom:e.nom,barType:e.type,currentFuts:s.length,maxFuts:u.maxFutsParBar}),disabled:!n||Y,className:`w-full p-4 rounded-xl flex items-center justify-between transition-all ${n&&!Y?t?"bg-emerald-900/50 hover:bg-emerald-900 hover:scale-[1.02]":"bg-teal-900/50 hover:bg-teal-900 hover:scale-[1.02]":"bg-neutral-800 opacity-50 cursor-not-allowed"}`},React.createElement("div",{className:"flex items-center gap-3"},React.createElement("span",{className:"text-2xl"},t?"\u{1F37A}":"\u{1F34E}"),React.createElement("div",{className:"text-left"},React.createElement("p",{className:"font-medium"},e.nom),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("div",{className:"flex gap-0.5"},Array.from({length:u.maxFutsParBar}).map((a,o)=>React.createElement("span",{key:o,className:`text-sm ${o<s.length?"":"opacity-30"}`},"\u{1F6E2}\uFE0F"))),React.createElement("span",{className:`text-sm font-bold ${r?"text-red-400":s.length>0?"text-yellow-400":"text-green-400"}`},s.length,"/",u.maxFutsParBar)))),r?React.createElement("span",{className:"text-red-400 text-xs font-bold"},"COMPLET"):n?React.createElement("span",{className:"text-green-400 text-xl"},"\u2192"):React.createElement("span",{className:"text-red-400 text-xs"},"Stock vide"))})),React.createElement("button",{onClick:()=>{Qt(!1),ct(null)},className:"w-full py-3 bg-neutral-700 rounded-lg mt-4"},"Fermer"))))):React.createElement(en,{onJoinSession:wa})};ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(tn,null));})();

</script>
</body>
</html>
